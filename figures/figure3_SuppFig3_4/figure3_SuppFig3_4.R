suppressWarnings({
  library(MCMCtreeR)
  library(ggplot2)
  library(tidyverse)
  })

#####################
#     FUNCTIONS     #
#####################

generate_MCMCtree_object <- function(tree) {
  tree_nexus <- as.character(c("#NEXUS",
                               "begin trees",
                               "",
                               tree,
                               "END;"))
  
  mcmctree_object <- readMCMCtree(tree_nexus, from.file = FALSE)
  
  return(mcmctree_object)
}

tidy_age_df <- function(df, group) {
  colnames(df) <- paste0(group, "_", sub("95%_", "CI", colnames(df)))
  
  df <- as.data.frame(df) %>%
    tibble::rownames_to_column("Node") %>%
    mutate_if(is.numeric, ~ . * 100)
  
  df$Node <- as.numeric(df$Node)
  
  return(df)
}


plot_corr <- function(list_to_plot, order_panel, labeller, n_row) {
  
  # remove redundant columns and outgroup nodes
  dates <- list_to_plot %>%
    reduce(full_join, by = "Node") %>%
    filter(Node > 50)
  
  dates
  
  # prepare tibble for ggplot
  tibble_to_plot <- dates %>%
    
    pivot_longer(cols = -c(Node, allTree_mean, allTree_CIlower, allTree_CIupper),
                 names_to = c("tree", "metric"),
                 names_sep = "_",
                 values_to = "age") %>%
    
    pivot_wider(names_from = metric,
                values_from = age) %>%
    
    mutate(calibration = if_else(Node %in% c(51, 52, 58, 81), "calib", "uncalib")) %>%
    mutate(label = case_when(Node == 51 ~ "1",
                             Node == 52 ~ "2",
                             Node == 58 ~ "3",
                             Node == 81 ~ "4",
                             Node == 57 ~ "Ph",
                             Node == 67 ~ "Dp",
                             Node == 68 ~ "Oc",
                             Node == 79 ~ "Cm",
                             Node == 83 ~ "Op",
                             Node == 85 ~ "An",
                             TRUE ~ ""))
  
  tibble_to_plot
  tibble_to_plot$tree <- factor(tibble_to_plot$tree,
                                levels = order_panel)
  
  plot <- ggplot(tibble_to_plot, aes(x = allTree_mean, y = mean, label = as.factor(label))) +
    
    geom_abline(col = "#818181", intercept = 0, slope = 1, linewidth = 0.5, linetype = "longdash") +
    
    # regression line
    geom_smooth(method = "lm", linewidth = 0.8, col = "grey80", fill = alpha("grey80", 0.3)) +
    
    # error bars
    geom_errorbar(aes(xmin = allTree_CIlower, xmax = allTree_CIupper, linewidth = calibration, col = calibration),
                  lineend = "round") +
    geom_errorbar(aes(ymin = CIlower, ymax = CIupper, linewidth = calibration, col = calibration),
                  lineend = "round") +
    
    scale_color_manual(values = c("#ffbbc6", "#b5c4ff")) +
    scale_discrete_manual("linewidth", values = c(1.3, 0.7)) +
    
    # scatterplot
    ggnewscale::new_scale_color() +
    geom_point(aes(col = calibration, size = calibration, stroke = calibration), shape = 1) +
    
    scale_color_manual(values = c("#ff3657", "#2552ff")) +
    scale_size_manual(values = c(2, 1)) +
    scale_discrete_manual("stroke", values = c(1.5, 0.9)) +
    
    ggpubr::stat_cor(method = "pearson", size = 4) +
    
    # node labels
    ggrepel::geom_text_repel(col = "#3d3d3d", force = 20,
                             min.segment.length = 0, box.padding = 0.5, max.overlaps = Inf) +
    
    scale_y_continuous(limits = c(0, max(tibble_to_plot$CIupper))) +
    
    facet_wrap(~tree, scales = "free", labeller = as_labeller(labeller), nrow = n_row) +
    
    xlab("Age (Ma)") +
    ylab("Age (Ma)") +
    
    theme_minimal() +
    theme(aspect.ratio = 1,
          strip.text = element_text(face = "bold", hjust = 0),
          panel.grid.minor.y = element_blank(),
          panel.grid.minor.x = element_blank(),
          axis.line = element_line(linewidth = 0.5),
          axis.text.y = element_text(size = 8),
          axis.title = element_text(size = 8, face = "bold"),
          strip.placement = "outside",
          legend.position = "none")
  
  return(plot)
}

#######################
#     ACTUAL CODE     #
#######################

## LOAD TREES

# all fossils all calibs
all_tree <- generate_MCMCtree_object(
  "((Scur: 4.219773, Iele: 4.219773) [&95%={3.11134, 5.02879}]: 0.847928, (((Blyn: 0.241970, Blin: 0.241970) [&95%={0.117836, 0.444496}]: 1.950249, (Afr1: 1.777969, (Bher: 1.174521, (Stsp: 0.969138, Tpla: 0.969138) [&95%={0.58477, 1.47382}]: 0.205383) [&95%={0.771598, 1.70877}]: 0.603448) [&95%={1.22482, 2.53927}]: 0.414251) [&95%={1.5764, 3.09379}]: 2.566664, (((Tlon: 0.546729, (Tita: 0.053884, (Tusa: 0.006246, Tjap: 0.006246) [&95%={0.0030127, 0.0115787}]: 0.047638) [&95%={0.0277487, 0.0962538}]: 0.492844) [&95%={0.290987, 0.912701}]: 0.797062, ((Lcry: 0.095241, Lpac: 0.095241) [&95%={0.0473564, 0.171604}]: 0.204119, (Lubb: 0.110925, (Lapu: 0.093216, (Lcou: 0.046321, Lart: 0.046321) [&95%={0.0249656, 0.0783802}]: 0.046896) [&95%={0.0579907, 0.143762}]: 0.017708) [&95%={0.0715813, 0.166401}]: 0.188435) [&95%={0.189242, 0.471811}]: 1.044431) [&95%={0.987341, 1.86372}]: 2.912188, (Lysp: 3.842969, (((Orub: 0.480215, (Ozsp: 0.391354, Cpil: 0.391354) [&95%={0.210897, 0.669802}]: 0.088861) [&95%={0.283668, 0.774374}]: 1.404082, ((Eosp: 1.277132, (Ldah: 0.658104, Etic: 0.658104) [&95%={0.362023, 1.05203}]: 0.619029) [&95%={0.884514, 1.79198}]: 0.269814, ((Mesp: 0.520730, Etex: 0.520730) [&95%={0.27876, 0.840053}]: 0.560543, (Puru: 0.484829, (Lpar: 0.252961, Lbir: 0.252961) [&95%={0.133407, 0.426697}]: 0.231869) [&95%={0.294901, 0.743298}]: 0.596444) [&95%={0.747637, 1.51445}]: 0.465673) [&95%={1.12893, 2.08991}]: 0.337351) [&95%={1.37722, 2.52529}]: 1.570895, ((Chis: 0.675839, C146: 0.675839) [&95%={0.338428, 1.19503}]: 2.336969, (Scry: 2.716030, ((Pped: 1.751478, (Pleu: 0.950784, Enor: 0.950784) [&95%={0.529732, 1.47453}]: 0.800694) [&95%={1.17721, 2.34243}]: 0.692859, ((Bosp: 1.498694, (Elam: 0.189694, Aema: 0.189694) [&95%={0.0948003, 0.345019}]: 1.309000) [&95%={0.977229, 2.06476}]: 0.660248, (Mosp: 1.569398, (Masp: 1.376977, ((Cqua: 0.862791, (Svet: 0.303675, Smuc: 0.303675) [&95%={0.167035, 0.493496}]: 0.559116) [&95%={0.607963, 1.16602}]: 0.210273, (Dmag: 0.676572, (Dgal: 0.368854, (Dpul: 0.050771, Dpli: 0.050771) [&95%={0.0247111, 0.093887}]: 0.318082) [&95%={0.208879, 0.586036}]: 0.307718) [&95%={0.442114, 0.958767}]: 0.396492) [&95%={0.803575, 1.39434}]: 0.303913) [&95%={1.04159, 1.76235}]: 0.192421) [&95%={1.19677, 1.989}]: 0.589544) [&95%={1.70202, 2.65638}]: 0.285395) [&95%={1.95883, 2.97862}]: 0.271693) [&95%={2.19476, 3.28248}]: 0.296778) [&95%={2.47306, 3.5837}]: 0.442385) [&95%={2.89719, 4.02122}]: 0.387777) [&95%={3.26456, 4.39515}]: 0.413010) [&95%={3.68053, 4.77305}]: 0.502905) [&95%={4.22395, 5.18676}]: 0.308817) [&95%={4.75982, 5.30522}];"
  )

# no branchiopoda
noBran_tree <- generate_MCMCtree_object(
  "((Scur: 4.220015, Iele: 4.220015) [&95%={3.00009, 5.03755}]: 0.842100, (((Blyn: 0.239601, Blin: 0.239601) [&95%={0.117592, 0.443604}]: 2.026717, (Afr1: 1.829969, (Bher: 1.192992, (Stsp: 0.984535, Tpla: 0.984535) [&95%={0.590026, 1.50627}]: 0.208457) [&95%={0.777684, 1.74821}]: 0.636977) [&95%={1.21446, 2.56195}]: 0.436350) [&95%={1.56026, 3.08333}]: 2.471943, (((Tlon: 0.549594, (Tita: 0.053834, (Tusa: 0.006217, Tjap: 0.006217) [&95%={0.0029742, 0.0115864}]: 0.047617) [&95%={0.0273952, 0.0968255}]: 0.495760) [&95%={0.287698, 0.921285}]: 0.818007, ((Lcry: 0.094578, Lpac: 0.094578) [&95%={0.0469603, 0.169665}]: 0.203253, (Lubb: 0.110515, (Lapu: 0.092874, (Lcou: 0.046124, Lart: 0.046124) [&95%={0.0247385, 0.0776826}]: 0.046750) [&95%={0.0574103, 0.144346}]: 0.017641) [&95%={0.0709617, 0.166016}]: 0.187316) [&95%={0.186574, 0.473043}]: 1.069770) [&95%={1.00159, 1.91522}]: 2.849222, (Lysp: 3.789934, (((Orub: 0.470913, (Ozsp: 0.382667, Cpil: 0.382667) [&95%={0.208873, 0.638899}]: 0.088246) [&95%={0.281795, 0.747727}]: 1.411210, ((Eosp: 1.266758, (Ldah: 0.651053, Etic: 0.651053) [&95%={0.355457, 1.04483}]: 0.615705) [&95%={0.864029, 1.78905}]: 0.272305, ((Mesp: 0.519980, Etex: 0.519980) [&95%={0.276721, 0.851711}]: 0.554661, (Puru: 0.484802, (Lpar: 0.253089, Lbir: 0.253089) [&95%={0.131228, 0.434983}]: 0.231713) [&95%={0.293755, 0.749046}]: 0.589840) [&95%={0.735676, 1.50766}]: 0.464421) [&95%={1.1005, 2.08919}]: 0.343060) [&95%={1.35492, 2.5096}]: 1.510034, ((Chis: 0.675914, C146: 0.675914) [&95%={0.33441, 1.19794}]: 2.259188, (Scry: 2.629779, ((Pped: 1.726883, (Pleu: 0.936047, Enor: 0.936047) [&95%={0.517609, 1.45624}]: 0.790836) [&95%={1.14778, 2.34184}]: 0.655093, ((Bosp: 1.452988, (Elam: 0.188823, Aema: 0.188823) [&95%={0.0929269, 0.343412}]: 1.264165) [&95%={0.926039, 2.04398}]: 0.657363, (Mosp: 1.531385, (Masp: 1.341708, ((Cqua: 0.841699, (Svet: 0.299925, Smuc: 0.299925) [&95%={0.162495, 0.494232}]: 0.541774) [&95%={0.589837, 1.13506}]: 0.206601, (Dmag: 0.664482, (Dgal: 0.361846, (Dpul: 0.050221, Dpli: 0.050221) [&95%={0.0242489, 0.0928014}]: 0.311626) [&95%={0.204554, 0.58043}]: 0.302635) [&95%={0.433852, 0.949848}]: 0.383818) [&95%={0.778563, 1.36486}]: 0.293408) [&95%={1.01359, 1.72867}]: 0.189677) [&95%={1.17066, 1.95461}]: 0.578966) [&95%={1.65935, 2.60829}]: 0.271625) [&95%={1.89632, 2.90033}]: 0.247803) [&95%={2.11063, 3.17859}]: 0.305322) [&95%={2.38653, 3.50281}]: 0.457054) [&95%={2.8126, 3.95861}]: 0.397778) [&95%={3.20054, 4.34828}]: 0.426889) [&95%={3.62269, 4.75049}]: 0.521438) [&95%={4.19425, 5.1781}]: 0.323854) [&95%={4.75841, 5.30404}];"
  )

# no anostraca
noAnos_tree <- generate_MCMCtree_object(
  "((Scur: 4.247477, Iele: 4.247477) [&95%={3.11672, 5.04004}]: 0.801827, (((Blyn: 0.231853, Blin: 0.231853) [&95%={0.112526, 0.42555}]: 1.680171, (Afr1: 1.573719, (Bher: 1.084377, (Stsp: 0.891700, Tpla: 0.891700) [&95%={0.532464, 1.36981}]: 0.192677) [&95%={0.697218, 1.58526}]: 0.489342) [&95%={1.10198, 2.20442}]: 0.338305) [&95%={1.39339, 2.65978}]: 2.799922, (((Tlon: 0.512555, (Tita: 0.052456, (Tusa: 0.006065, Tjap: 0.006065) [&95%={0.0029342, 0.01124}]: 0.046390) [&95%={0.026712, 0.094725}]: 0.460099) [&95%={0.271872, 0.888176}]: 0.721538, ((Lcry: 0.092790, Lpac: 0.092790) [&95%={0.0454732, 0.168038}]: 0.198408, (Lubb: 0.107884, (Lapu: 0.090647, (Lcou: 0.044938, Lart: 0.044938) [&95%={0.0238055, 0.0759825}]: 0.045709) [&95%={0.055973, 0.139996}]: 0.017237) [&95%={0.0690692, 0.16169}]: 0.183314) [&95%={0.181495, 0.46037}]: 0.942895) [&95%={0.762019, 1.88651}]: 2.965834, (Lysp: 3.781194, (((Orub: 0.465127, (Ozsp: 0.378894, Cpil: 0.378894) [&95%={0.203484, 0.644187}]: 0.086233) [&95%={0.273747, 0.74813}]: 1.368140, ((Eosp: 1.265645, (Ldah: 0.650974, Etic: 0.650974) [&95%={0.351324, 1.04633}]: 0.614671) [&95%={0.871121, 1.74187}]: 0.256423, ((Mesp: 0.517077, Etex: 0.517077) [&95%={0.271831, 0.858251}]: 0.555275, (Puru: 0.473739, (Lpar: 0.247471, Lbir: 0.247471) [&95%={0.130301, 0.423006}]: 0.226269) [&95%={0.28829, 0.729703}]: 0.598612) [&95%={0.733622, 1.49435}]: 0.449716) [&95%={1.1124, 2.03284}]: 0.311200) [&95%={1.34794, 2.45323}]: 1.560067, ((Chis: 0.668555, C146: 0.668555) [&95%={0.325237, 1.19423}]: 2.281531, (Scry: 2.653174, ((Pped: 1.705337, (Pleu: 0.942058, Enor: 0.942058) [&95%={0.513377, 1.46503}]: 0.763280) [&95%={1.17194, 2.28747}]: 0.684001, ((Bosp: 1.470556, (Elam: 0.185330, Aema: 0.185330) [&95%={0.0909854, 0.337982}]: 1.285226) [&95%={0.955464, 1.99704}]: 0.639987, (Mosp: 1.545645, (Masp: 1.361030, ((Cqua: 0.855994, (Svet: 0.300011, Smuc: 0.300011) [&95%={0.160053, 0.494432}]: 0.555983) [&95%={0.585707, 1.16984}]: 0.207883, (Dmag: 0.670447, (Dgal: 0.363794, (Dpul: 0.049031, Dpli: 0.049031) [&95%={0.0237744, 0.0889217}]: 0.314763) [&95%={0.202607, 0.584751}]: 0.306653) [&95%={0.438027, 0.961254}]: 0.393430) [&95%={0.777588, 1.39601}]: 0.297153) [&95%={1.02105, 1.74086}]: 0.184614) [&95%={1.17789, 1.95948}]: 0.564899) [&95%={1.63951, 2.61857}]: 0.278795) [&95%={1.87689, 2.92463}]: 0.263835) [&95%={2.09899, 3.20886}]: 0.296912) [&95%={2.37439, 3.5311}]: 0.443248) [&95%={2.79866, 3.97308}]: 0.387860) [&95%={3.17452, 4.35847}]: 0.418734) [&95%={3.59869, 4.73798}]: 0.512018) [&95%={4.16037, 5.16822}]: 0.337358) [&95%={4.75522, 5.30335}];"
  )

# no notostraca
noNoto_tree <- generate_MCMCtree_object(
  "((Scur: 4.224910, Iele: 4.224910) [&95%={3.08387, 5.02739}]: 0.837357, (((Blyn: 0.242527, Blin: 0.242527) [&95%={0.117412, 0.452409}]: 2.034813, (Afr1: 1.839944, (Bher: 1.191719, (Stsp: 0.982152, Tpla: 0.982152) [&95%={0.591242, 1.50312}]: 0.209567) [&95%={0.775139, 1.73432}]: 0.648225) [&95%={1.25119, 2.57013}]: 0.437397) [&95%={1.60192, 3.09237}]: 2.462746, (((Tlon: 0.558969, (Tita: 0.054025, (Tusa: 0.006246, Tjap: 0.006246) [&95%={0.0029733, 0.0116418}]: 0.047779) [&95%={0.0274949, 0.0969601}]: 0.504944) [&95%={0.296873, 0.945156}]: 0.799834, ((Lcry: 0.095232, Lpac: 0.095232) [&95%={0.0473386, 0.173843}]: 0.206480, (Lubb: 0.111434, (Lapu: 0.093649, (Lcou: 0.046334, Lart: 0.046334) [&95%={0.0246887, 0.0790523}]: 0.047314) [&95%={0.0576681, 0.145723}]: 0.017785) [&95%={0.0712579, 0.16893}]: 0.190278) [&95%={0.188362, 0.48556}]: 1.057091) [&95%={0.99764, 1.89321}]: 2.869965, (Lysp: 3.811579, (((Orub: 0.480175, (Ozsp: 0.391134, Cpil: 0.391134) [&95%={0.208613, 0.667648}]: 0.089041) [&95%={0.2831, 0.774888}]: 1.385745, ((Eosp: 1.262552, (Ldah: 0.652745, Etic: 0.652745) [&95%={0.353393, 1.05813}]: 0.609807) [&95%={0.869617, 1.76659}]: 0.268579, ((Mesp: 0.521293, Etex: 0.521293) [&95%={0.284003, 0.850255}]: 0.552053, (Puru: 0.482697, (Lpar: 0.251381, Lbir: 0.251381) [&95%={0.132509, 0.429422}]: 0.231317) [&95%={0.297278, 0.742688}]: 0.590648) [&95%={0.742947, 1.51212}]: 0.457785) [&95%={1.10919, 2.06739}]: 0.334790) [&95%={1.35645, 2.49508}]: 1.554844, ((Chis: 0.690865, C146: 0.690865) [&95%={0.342768, 1.23041}]: 2.280750, (Scry: 2.672954, ((Pped: 1.736552, (Pleu: 0.942851, Enor: 0.942851) [&95%={0.51347, 1.45592}]: 0.793701) [&95%={1.15703, 2.33326}]: 0.670792, ((Bosp: 1.462891, (Elam: 0.189250, Aema: 0.189250) [&95%={0.0937754, 0.342349}]: 1.273641) [&95%={0.956659, 2.03991}]: 0.660995, (Mosp: 1.540991, (Masp: 1.351518, ((Cqua: 0.846688, (Svet: 0.300489, Smuc: 0.300489) [&95%={0.164338, 0.492352}]: 0.546200) [&95%={0.590352, 1.1519}]: 0.207825, (Dmag: 0.667994, (Dgal: 0.363165, (Dpul: 0.050490, Dpli: 0.050490) [&95%={0.0245871, 0.0931652}]: 0.312675) [&95%={0.205371, 0.583375}]: 0.304829) [&95%={0.43764, 0.957626}]: 0.386519) [&95%={0.783869, 1.38301}]: 0.297005) [&95%={1.02742, 1.75224}]: 0.189473) [&95%={1.17846, 1.973}]: 0.582895) [&95%={1.66496, 2.62802}]: 0.283458) [&95%={1.91031, 2.93873}]: 0.265610) [&95%={2.14615, 3.23112}]: 0.298661) [&95%={2.41237, 3.54287}]: 0.449149) [&95%={2.82852, 3.98531}]: 0.390815) [&95%={3.20801, 4.36942}]: 0.417189) [&95%={3.63226, 4.7559}]: 0.511319) [&95%={4.19308, 5.1789}]: 0.322180) [&95%={4.76245, 5.30356}];"
  )

# no cladocera
noClad_tree <- generate_MCMCtree_object(
  "((Scur: 4.139347, Iele: 4.139347) [&95%={2.97163, 4.97641}]: 0.924209, (((Blyn: 0.243048, Blin: 0.243048) [&95%={0.117393, 0.448642}]: 1.971521, (Afr1: 1.796069, (Bher: 1.183045, (Stsp: 0.975887, Tpla: 0.975887) [&95%={0.592785, 1.47968}]: 0.207157) [&95%={0.778507, 1.71241}]: 0.613024) [&95%={1.23843, 2.55117}]: 0.418501) [&95%={1.57633, 3.11415}]: 2.608880, (((Tlon: 0.551730, (Tita: 0.054686, (Tusa: 0.006305, Tjap: 0.006305) [&95%={0.0030276, 0.011736}]: 0.048382) [&95%={0.0283502, 0.0978542}]: 0.497043) [&95%={0.293461, 0.9218}]: 0.799113, ((Lcry: 0.095756, Lpac: 0.095756) [&95%={0.0478566, 0.171114}]: 0.206469, (Lubb: 0.111874, (Lapu: 0.094016, (Lcou: 0.046612, Lart: 0.046612) [&95%={0.0249691, 0.0787768}]: 0.047404) [&95%={0.0584193, 0.145986}]: 0.017859) [&95%={0.0719859, 0.167687}]: 0.190350) [&95%={0.188397, 0.47927}]: 1.048618) [&95%={0.992989, 1.88171}]: 2.962046, (Lysp: 3.893343, (((Orub: 0.483674, (Ozsp: 0.394025, Cpil: 0.394025) [&95%={0.213151, 0.663392}]: 0.089649) [&95%={0.285722, 0.77229}]: 1.409531, ((Eosp: 1.279903, (Ldah: 0.661642, Etic: 0.661642) [&95%={0.361307, 1.06687}]: 0.618262) [&95%={0.875997, 1.80089}]: 0.273065, ((Mesp: 0.523825, Etex: 0.523825) [&95%={0.281787, 0.855593}]: 0.559968, (Puru: 0.487047, (Lpar: 0.254679, Lbir: 0.254679) [&95%={0.131934, 0.431542}]: 0.232368) [&95%={0.292835, 0.747422}]: 0.596745) [&95%={0.748434, 1.52283}]: 0.469176) [&95%={1.12423, 2.09821}]: 0.340236) [&95%={1.37985, 2.52538}]: 1.606324, ((Chis: 0.686751, C146: 0.686751) [&95%={0.335609, 1.23169}]: 2.365064, (Scry: 2.751697, ((Pped: 1.776967, (Pleu: 0.964611, Enor: 0.964611) [&95%={0.532195, 1.49664}]: 0.812357) [&95%={1.18201, 2.38281}]: 0.696752, ((Bosp: 1.505042, (Elam: 0.191654, Aema: 0.191654) [&95%={0.0942498, 0.344898}]: 1.313388) [&95%={0.962302, 2.08866}]: 0.676629, (Mosp: 1.577192, (Masp: 1.381595, ((Cqua: 0.862771, (Svet: 0.303979, Smuc: 0.303979) [&95%={0.165407, 0.4966}]: 0.558792) [&95%={0.599218, 1.17047}]: 0.212911, (Dmag: 0.680825, (Dgal: 0.372219, (Dpul: 0.050958, Dpli: 0.050958) [&95%={0.0248967, 0.0945738}]: 0.321261) [&95%={0.206747, 0.595064}]: 0.308606) [&95%={0.448926, 0.959447}]: 0.394856) [&95%={0.792998, 1.40504}]: 0.305913) [&95%={1.03517, 1.77947}]: 0.195597) [&95%={1.19465, 2.01068}]: 0.604479) [&95%={1.69086, 2.69441}]: 0.292048) [&95%={1.94181, 3.00503}]: 0.277977) [&95%={2.18593, 3.30998}]: 0.300118) [&95%={2.45823, 3.62522}]: 0.447714) [&95%={2.88818, 4.06879}]: 0.393815) [&95%={3.26556, 4.43433}]: 0.419545) [&95%={3.69269, 4.81593}]: 0.510562) [&95%={4.25936, 5.22853}]: 0.240106) [&95%={4.75787, 5.30541}];"
  )

# no cladocera no branchiopoda
noCladBra_tree <- generate_MCMCtree_object(
  "((Scur: 4.134532, Iele: 4.134532) [&95%={3.03883, 4.96157}]: 0.923327, (((Blyn: 0.245021, Blin: 0.245021) [&95%={0.120405, 0.459631}]: 2.065234, (Afr1: 1.868978, (Bher: 1.214898, (Stsp: 1.003247, Tpla: 1.003247) [&95%={0.608011, 1.51854}]: 0.211651) [&95%={0.796745, 1.75182}]: 0.654080) [&95%={1.26952, 2.63106}]: 0.441277) [&95%={1.62747, 3.15186}]: 2.508718, (((Tlon: 0.551047, (Tita: 0.054894, (Tusa: 0.006332, Tjap: 0.006332) [&95%={0.003073, 0.0117458}]: 0.048562) [&95%={0.0282123, 0.0986317}]: 0.496153) [&95%={0.292021, 0.923889}]: 0.808669, ((Lcry: 0.096571, Lpac: 0.096571) [&95%={0.0479956, 0.173867}]: 0.206262, (Lubb: 0.112224, (Lapu: 0.094281, (Lcou: 0.046889, Lart: 0.046889) [&95%={0.0253181, 0.0797697}]: 0.047392) [&95%={0.0589596, 0.144782}]: 0.017943) [&95%={0.0729005, 0.167623}]: 0.190608) [&95%={0.18959, 0.474712}]: 1.056883) [&95%={0.998951, 1.8955}]: 2.942745, (Lysp: 3.878950, (((Orub: 0.487577, (Ozsp: 0.397507, Cpil: 0.397507) [&95%={0.214912, 0.671148}]: 0.090070) [&95%={0.289944, 0.774341}]: 1.412227, ((Eosp: 1.284057, (Ldah: 0.666154, Etic: 0.666154) [&95%={0.36931, 1.0646}]: 0.617903) [&95%={0.883164, 1.79488}]: 0.272458, ((Mesp: 0.525153, Etex: 0.525153) [&95%={0.281549, 0.857039}]: 0.564384, (Puru: 0.488422, (Lpar: 0.255222, Lbir: 0.255222) [&95%={0.135518, 0.435252}]: 0.233200) [&95%={0.299276, 0.756447}]: 0.601115) [&95%={0.753685, 1.5277}]: 0.466978) [&95%={1.12576, 2.09107}]: 0.343289) [&95%={1.37918, 2.52758}]: 1.582346, ((Chis: 0.688953, C146: 0.688953) [&95%={0.331018, 1.22283}]: 2.340412, (Scry: 2.727092, ((Pped: 1.778118, (Pleu: 0.966328, Enor: 0.966328) [&95%={0.534131, 1.49679}]: 0.811789) [&95%={1.18177, 2.37577}]: 0.681469, ((Bosp: 1.504794, (Elam: 0.191517, Aema: 0.191517) [&95%={0.0943161, 0.349585}]: 1.313277) [&95%={0.969627, 2.07869}]: 0.670439, (Mosp: 1.574338, (Masp: 1.380521, ((Cqua: 0.865726, (Svet: 0.307733, Smuc: 0.307733) [&95%={0.169226, 0.503808}]: 0.557993) [&95%={0.609587, 1.16223}]: 0.211863, (Dmag: 0.682124, (Dgal: 0.371906, (Dpul: 0.051121, Dpli: 0.051121) [&95%={0.0249034, 0.0934613}]: 0.320785) [&95%={0.209604, 0.588341}]: 0.310218) [&95%={0.457242, 0.953708}]: 0.395465) [&95%={0.804219, 1.40129}]: 0.302932) [&95%={1.04786, 1.76664}]: 0.193817) [&95%={1.20963, 1.9899}]: 0.600895) [&95%={1.7073, 2.67884}]: 0.284354) [&95%={1.95595, 2.98601}]: 0.267505) [&95%={2.18746, 3.27288}]: 0.302273) [&95%={2.45919, 3.58972}]: 0.452784) [&95%={2.88834, 4.0401}]: 0.396801) [&95%={3.26526, 4.4223}]: 0.423511) [&95%={3.70222, 4.81262}]: 0.516512) [&95%={4.26141, 5.22391}]: 0.238886) [&95%={4.75519, 5.30389}];"
)

# no cladocera no anostraca
noCladAnos_tree <- generate_MCMCtree_object(
  "((Scur: 4.201155, Iele: 4.201155) [&95%={3.0983, 5.0071}]: 0.851367, (((Blyn: 0.241825, Blin: 0.241825) [&95%={0.117651, 0.451596}]: 2.017190, (Afr1: 1.815344, (Bher: 1.177589, (Stsp: 0.970868, Tpla: 0.970868) [&95%={0.565691, 1.47939}]: 0.206721) [&95%={0.746676, 1.72222}]: 0.637755) [&95%={1.17281, 2.615}]: 0.443671) [&95%={1.49052, 3.13493}]: 2.469315, (((Tlon: 0.572271, (Tita: 0.054213, (Tusa: 0.006272, Tjap: 0.006272) [&95%={0.0029513, 0.0118497}]: 0.047941) [&95%={0.0278711, 0.0984691}]: 0.518058) [&95%={0.297563, 0.984126}]: 0.885836, ((Lcry: 0.095635, Lpac: 0.095635) [&95%={0.0464535, 0.173751}]: 0.207362, (Lubb: 0.111116, (Lapu: 0.093254, (Lcou: 0.046216, Lart: 0.046216) [&95%={0.0246056, 0.0782585}]: 0.047038) [&95%={0.0574958, 0.144356}]: 0.017862) [&95%={0.0711455, 0.166851}]: 0.191880) [&95%={0.186637, 0.486342}]: 1.155111) [&95%={1.058, 2.02388}]: 2.774523, (Lysp: 3.821206, (((Orub: 0.477038, (Ozsp: 0.388075, Cpil: 0.388075) [&95%={0.204984, 0.655393}]: 0.088963) [&95%={0.277834, 0.767455}]: 1.371859, ((Eosp: 1.236943, (Ldah: 0.647251, Etic: 0.647251) [&95%={0.35246, 1.04623}]: 0.589692) [&95%={0.847193, 1.74594}]: 0.267581, ((Mesp: 0.517991, Etex: 0.517991) [&95%={0.27991, 0.843483}]: 0.543305, (Puru: 0.480330, (Lpar: 0.250950, Lbir: 0.250950) [&95%={0.130095, 0.426516}]: 0.229379) [&95%={0.290917, 0.744103}]: 0.580966) [&95%={0.727977, 1.47376}]: 0.443228) [&95%={1.08401, 2.05087}]: 0.344373) [&95%={1.32525, 2.5132}]: 1.588452, ((Chis: 0.686917, C146: 0.686917) [&95%={0.335007, 1.21618}]: 2.312213, (Scry: 2.704118, ((Pped: 1.735295, (Pleu: 0.940330, Enor: 0.940330) [&95%={0.511338, 1.47366}]: 0.794965) [&95%={1.12752, 2.37684}]: 0.704278, ((Bosp: 1.463974, (Elam: 0.190061, Aema: 0.190061) [&95%={0.0934301, 0.347148}]: 1.273914) [&95%={0.934442, 2.08056}]: 0.686191, (Mosp: 1.546671, (Masp: 1.354474, ((Cqua: 0.851487, (Svet: 0.304378, Smuc: 0.304378) [&95%={0.166194, 0.497385}]: 0.547110) [&95%={0.592956, 1.15237}]: 0.207493, (Dmag: 0.673977, (Dgal: 0.367911, (Dpul: 0.050829, Dpli: 0.050829) [&95%={0.0246177, 0.094575}]: 0.317082) [&95%={0.206541, 0.592697}]: 0.306066) [&95%={0.444997, 0.956679}]: 0.385002) [&95%={0.780254, 1.37981}]: 0.295494) [&95%={1.01797, 1.74999}]: 0.192198) [&95%={1.17358, 1.98273}]: 0.603494) [&95%={1.67588, 2.64358}]: 0.289407) [&95%={1.93307, 2.96005}]: 0.264545) [&95%={2.1642, 3.24185}]: 0.295012) [&95%={2.43616, 3.54644}]: 0.438218) [&95%={2.85827, 3.99588}]: 0.383858) [&95%={3.23065, 4.37039}]: 0.411424) [&95%={3.64924, 4.7526}]: 0.495700) [&95%={4.18798, 5.17229}]: 0.324191) [&95%={4.75665, 5.30323}];"
)

# no cladocera no notostraca
noCladNoto_tree <- generate_MCMCtree_object(
  "((Scur: 4.247756, Iele: 4.247756) [&95%={3.1464, 5.0403}]: 0.797138, (((Blyn: 0.233916, Blin: 0.233916) [&95%={0.114059, 0.433653}]: 1.740134, (Afr1: 1.628984, (Bher: 1.120530, (Stsp: 0.924773, Tpla: 0.924773) [&95%={0.549438, 1.42207}]: 0.195757) [&95%={0.722794, 1.6553}]: 0.508454) [&95%={1.14017, 2.28655}]: 0.345065) [&95%={1.43375, 2.70223}]: 2.726448, (((Tlon: 0.513578, (Tita: 0.052222, (Tusa: 0.006072, Tjap: 0.006072) [&95%={0.0029247, 0.0112436}]: 0.046150) [&95%={0.0270945, 0.0927505}]: 0.461356) [&95%={0.274211, 0.885817}]: 0.719390, ((Lcry: 0.092269, Lpac: 0.092269) [&95%={0.0460043, 0.162943}]: 0.197914, (Lubb: 0.107896, (Lapu: 0.090679, (Lcou: 0.045073, Lart: 0.045073) [&95%={0.0245473, 0.0765045}]: 0.045607) [&95%={0.057059, 0.140255}]: 0.017217) [&95%={0.0702821, 0.162234}]: 0.182287) [&95%={0.18092, 0.460337}]: 0.942785) [&95%={0.770745, 1.86328}]: 2.953265, (Lysp: 3.766784, (((Orub: 0.466891, (Ozsp: 0.380506, Cpil: 0.380506) [&95%={0.205049, 0.6362}]: 0.086385) [&95%={0.276506, 0.739557}]: 1.371781, ((Eosp: 1.272413, (Ldah: 0.662376, Etic: 0.662376) [&95%={0.360361, 1.06234}]: 0.610037) [&95%={0.881645, 1.74437}]: 0.255128, ((Mesp: 0.516205, Etex: 0.516205) [&95%={0.275225, 0.849738}]: 0.556991, (Puru: 0.474632, (Lpar: 0.246466, Lbir: 0.246466) [&95%={0.130187, 0.421034}]: 0.228167) [&95%={0.288697, 0.735723}]: 0.598564) [&95%={0.734738, 1.49578}]: 0.454345) [&95%={1.11579, 2.01758}]: 0.311131) [&95%={1.36183, 2.42741}]: 1.538449, ((Chis: 0.671583, C146: 0.671583) [&95%={0.330696, 1.22868}]: 2.261676, (Scry: 2.638880, ((Pped: 1.708198, (Pleu: 0.944121, Enor: 0.944121) [&95%={0.519412, 1.47032}]: 0.764078) [&95%={1.18077, 2.28517}]: 0.669929, ((Bosp: 1.477254, (Elam: 0.185221, Aema: 0.185221) [&95%={0.0908792, 0.335907}]: 1.292033) [&95%={0.974766, 1.99114}]: 0.626180, (Mosp: 1.547247, (Masp: 1.361963, ((Cqua: 0.857963, (Svet: 0.299694, Smuc: 0.299694) [&95%={0.161638, 0.490947}]: 0.558269) [&95%={0.593166, 1.17341}]: 0.206988, (Dmag: 0.670602, (Dgal: 0.364422, (Dpul: 0.049026, Dpli: 0.049026) [&95%={0.0241461, 0.0898911}]: 0.315396) [&95%={0.20423, 0.579632}]: 0.306180) [&95%={0.445078, 0.946283}]: 0.394348) [&95%={0.788138, 1.39704}]: 0.297012) [&95%={1.03311, 1.74441}]: 0.185284) [&95%={1.19305, 1.95823}]: 0.556187) [&95%={1.65418, 2.60035}]: 0.274693) [&95%={1.88423, 2.89611}]: 0.260753) [&95%={2.1156, 3.18102}]: 0.294378) [&95%={2.37804, 3.49311}]: 0.443863) [&95%={2.79713, 3.94692}]: 0.389663) [&95%={3.17651, 4.32922}]: 0.419450) [&95%={3.59685, 4.72715}]: 0.514264) [&95%={4.15948, 5.16166}]: 0.344396) [&95%={4.75344, 5.30056}];"
)


# concordant genes
concGenes_tree <- generate_MCMCtree_object(
  "((Scur: 4.410643, Iele: 4.410643) [&95%={3.38514, 5.1063}]: 0.662820, (((Blyn: 0.220810, Blin: 0.220810) [&95%={0.110373, 0.398777}]: 1.788774, (Afr1: 1.522216, (Bher: 1.002096, (Stsp: 0.837776, Tpla: 0.837776) [&95%={0.504606, 1.24958}]: 0.164320) [&95%={0.651444, 1.43333}]: 0.520120) [&95%={1.05316, 2.14865}]: 0.487368) [&95%={1.45172, 2.78506}]: 2.808049, (((Tlon: 0.499094, (Tita: 0.053950, (Tusa: 0.003500, Tjap: 0.003500) [&95%={0.00146, 0.0069771}]: 0.050450) [&95%={0.0276284, 0.0967401}]: 0.445145) [&95%={0.273935, 0.816075}]: 0.763122, ((Lcry: 0.080118, Lpac: 0.080118) [&95%={0.0432566, 0.134418}]: 0.104148, (Lubb: 0.105204, (Lapu: 0.086654, (Lcou: 0.049103, Lart: 0.049103) [&95%={0.0268873, 0.0820495}]: 0.037551) [&95%={0.054773, 0.132149}]: 0.018550) [&95%={0.0690105, 0.155682}]: 0.079063) [&95%={0.123687, 0.274869}]: 1.077949) [&95%={0.921066, 1.72453}]: 2.968828, (Lysp: 3.818818, (((Orub: 0.384246, (Ozsp: 0.273430, Cpil: 0.273430) [&95%={0.148486, 0.460916}]: 0.110816) [&95%={0.232117, 0.604074}]: 1.355989, ((Eosp: 1.111958, (Ldah: 0.528350, Etic: 0.528350) [&95%={0.289393, 0.851824}]: 0.583608) [&95%={0.770483, 1.55033}]: 0.250260, ((Mesp: 0.398024, Etex: 0.398024) [&95%={0.216095, 0.656061}]: 0.526958, (Puru: 0.365744, (Lpar: 0.176717, Lbir: 0.176717) [&95%={0.0925607, 0.305864}]: 0.189027) [&95%={0.224437, 0.570051}]: 0.559238) [&95%={0.637102, 1.28714}]: 0.437237) [&95%={0.998726, 1.83427}]: 0.378016) [&95%={1.2731, 2.32616}]: 1.618386, ((Chis: 0.598101, C146: 0.598101) [&95%={0.298817, 1.07863}]: 2.318251, (Scry: 2.606920, ((Pped: 1.649502, (Pleu: 0.852736, Enor: 0.852736) [&95%={0.46916, 1.32902}]: 0.796766) [&95%={1.10789, 2.22476}]: 0.650224, ((Bosp: 1.480920, (Elam: 0.224096, Aema: 0.224096) [&95%={0.111344, 0.403983}]: 1.256824) [&95%={0.97583, 2.0092}]: 0.533028, (Mosp: 1.477096, (Masp: 1.279518, ((Cqua: 0.803626, (Svet: 0.283511, Smuc: 0.283511) [&95%={0.1572, 0.457134}]: 0.520114) [&95%={0.569925, 1.08023}]: 0.161238, (Dmag: 0.635519, (Dgal: 0.324888, (Dpul: 0.044501, Dpli: 0.044501) [&95%={0.0219897, 0.0817351}]: 0.280387) [&95%={0.185733, 0.518396}]: 0.310630) [&95%={0.425331, 0.893488}]: 0.329345) [&95%={0.717954, 1.25304}]: 0.314655) [&95%={0.970374, 1.6481}]: 0.197577) [&95%={1.13117, 1.87694}]: 0.536853) [&95%={1.57388, 2.49536}]: 0.285777) [&95%={1.8183, 2.80875}]: 0.307195) [&95%={2.0827, 3.14978}]: 0.309432) [&95%={2.37077, 3.47739}]: 0.442268) [&95%={2.78902, 3.9102}]: 0.460198) [&95%={3.23367, 4.35544}]: 0.412225) [&95%={3.65743, 4.73445}]: 0.586589) [&95%={4.3165, 5.19455}]: 0.255831) [&95%={4.76459, 5.30569}];"
  )

# disconcordant genes
discGenes_tree <- generate_MCMCtree_object(
  "((Scur: 4.187072, Iele: 4.187072) [&95%={2.97714, 5.02179}]: 0.879085, (((Blyn: 0.250772, Blin: 0.250772) [&95%={0.122482, 0.470157}]: 2.012573, (Afr1: 1.853364, (Bher: 1.223286, (Stsp: 1.007885, Tpla: 1.007885) [&95%={0.609887, 1.55483}]: 0.215401) [&95%={0.804333, 1.81518}]: 0.630079) [&95%={1.28063, 2.66379}]: 0.409981) [&95%={1.61254, 3.21222}]: 2.485445, (((Tlon: 0.564856, (Tita: 0.054820, (Tusa: 0.006977, Tjap: 0.006977) [&95%={0.0033328, 0.0131084}]: 0.047843) [&95%={0.0284082, 0.0988183}]: 0.510036) [&95%={0.299273, 0.94263}]: 0.799882, ((Lcry: 0.096172, Lpac: 0.096172) [&95%={0.0472199, 0.174637}]: 0.221530, (Lubb: 0.113272, (Lapu: 0.095101, (Lcou: 0.046437, Lart: 0.046437) [&95%={0.024633, 0.0797035}]: 0.048664) [&95%={0.0584061, 0.150015}]: 0.018171) [&95%={0.0724126, 0.174252}]: 0.204429) [&95%={0.196594, 0.507935}]: 1.047036) [&95%={1.00941, 1.89746}]: 2.887535, (Lysp: 3.832055, (((Orub: 0.505680, (Ozsp: 0.419014, Cpil: 0.419014) [&95%={0.22558, 0.710318}]: 0.086666) [&95%={0.29853, 0.816109}]: 1.423345, ((Eosp: 1.324833, (Ldah: 0.696898, Etic: 0.696898) [&95%={0.379146, 1.12241}]: 0.627935) [&95%={0.904136, 1.86703}]: 0.278943, ((Mesp: 0.549384, Etex: 0.549384) [&95%={0.295243, 0.898528}]: 0.576506, (Puru: 0.511952, (Lpar: 0.271766, Lbir: 0.271766) [&95%={0.142707, 0.462402}]: 0.240185) [&95%={0.311927, 0.78891}]: 0.613938) [&95%={0.783361, 1.5878}]: 0.477886) [&95%={1.1629, 2.16761}]: 0.325250) [&95%={1.4049, 2.57632}]: 1.526565, ((Chis: 0.707636, C146: 0.707636) [&95%={0.343416, 1.26372}]: 2.309382, (Scry: 2.726092, ((Pped: 1.776956, (Pleu: 0.973818, Enor: 0.973818) [&95%={0.536009, 1.51186}]: 0.803138) [&95%={1.18492, 2.3707}]: 0.687596, ((Bosp: 1.493684, (Elam: 0.183975, Aema: 0.183975) [&95%={0.0899519, 0.33911}]: 1.309708) [&95%={0.953345, 2.06883}]: 0.687247, (Mosp: 1.580724, (Masp: 1.387575, ((Cqua: 0.870445, (Svet: 0.309222, Smuc: 0.309222) [&95%={0.167876, 0.505395}]: 0.561223) [&95%={0.606521, 1.18387}]: 0.218368, (Dmag: 0.684991, (Dgal: 0.379407, (Dpul: 0.052955, Dpli: 0.052955) [&95%={0.0256191, 0.098304}]: 0.326452) [&95%={0.215765, 0.606227}]: 0.305584) [&95%={0.45108, 0.983171}]: 0.403822) [&95%={0.810658, 1.42573}]: 0.298762) [&95%={1.04845, 1.78376}]: 0.193149) [&95%={1.20434, 2.0056}]: 0.600207) [&95%={1.71572, 2.68125}]: 0.283621) [&95%={1.96575, 2.98973}]: 0.261540) [&95%={2.18786, 3.2771}]: 0.290927) [&95%={2.45255, 3.58266}]: 0.438572) [&95%={2.86624, 4.01076}]: 0.376464) [&95%={3.23408, 4.38214}]: 0.420218) [&95%={3.66715, 4.7749}]: 0.496518) [&95%={4.20398, 5.18272}]: 0.317367) [&95%={4.75967, 5.30496}];"
  )

# no Lynceus
noLysp_tree <- generate_MCMCtree_object(
  "((Scur: 4.751996, Iele: 4.751996) [&95%={3.40817, 5.94712}]: 0.725441, (((Blyn: 0.260769, Blin: 0.260769) [&95%={0.123994, 0.48692}]: 2.076535, (Afr1: 1.890004, (Bher: 1.242415, (Stsp: 1.020121, Tpla: 1.020121) [&95%={0.614894, 1.55535}]: 0.222293) [&95%={0.810808, 1.80536}]: 0.647589) [&95%={1.29875, 2.69373}]: 0.447300) [&95%={1.67792, 3.28534}]: 2.589741, (((Tlon: 0.575889, (Tita: 0.057815, (Tusa: 0.006826, Tjap: 0.006826) [&95%={0.0032592, 0.0129029}]: 0.050989) [&95%={0.0294467, 0.104354}]: 0.518074) [&95%={0.306195, 0.963251}]: 0.813203, ((Lcry: 0.100615, Lpac: 0.100615) [&95%={0.0495909, 0.180689}]: 0.218486, (Lubb: 0.117756, (Lapu: 0.098742, (Lcou: 0.049122, Lart: 0.049122) [&95%={0.0261243, 0.0832176}]: 0.049620) [&95%={0.0613639, 0.153002}]: 0.019014) [&95%={0.0760656, 0.177072}]: 0.201344) [&95%={0.200318, 0.506204}]: 1.069992) [&95%={1.01918, 1.95496}]: 2.971289, (((Orub: 0.515363, (Ozsp: 0.419178, Cpil: 0.419178) [&95%={0.223458, 0.716172}]: 0.096185) [&95%={0.302497, 0.835119}]: 1.504917, ((Eosp: 1.370450, (Ldah: 0.703538, Etic: 0.703538) [&95%={0.381435, 1.12427}]: 0.666912) [&95%={0.937885, 1.93336}]: 0.290792, ((Mesp: 0.559873, Etex: 0.559873) [&95%={0.296501, 0.931635}]: 0.597182, (Puru: 0.520734, (Lpar: 0.271836, Lbir: 0.271836) [&95%={0.141438, 0.462651}]: 0.248898) [&95%={0.315562, 0.8012}]: 0.636321) [&95%={0.797405, 1.62947}]: 0.504187) [&95%={1.19882, 2.24781}]: 0.359038) [&95%={1.46421, 2.71531}]: 1.677762, ((Chis: 0.740703, C146: 0.740703) [&95%={0.366467, 1.31628}]: 2.468503, (Scry: 2.893446, ((Pped: 1.868406, (Pleu: 1.015709, Enor: 1.015709) [&95%={0.564225, 1.5786}]: 0.852696) [&95%={1.24399, 2.50079}]: 0.732037, ((Bosp: 1.590743, (Elam: 0.203045, Aema: 0.203045) [&95%={0.098048, 0.372096}]: 1.387699) [&95%={1.00998, 2.20453}]: 0.707238, (Mosp: 1.668676, (Masp: 1.460445, ((Cqua: 0.914609, (Svet: 0.327823, Smuc: 0.327823) [&95%={0.177732, 0.534488}]: 0.586786) [&95%={0.634605, 1.2384}]: 0.223159, (Dmag: 0.716817, (Dgal: 0.392929, (Dpul: 0.054822, Dpli: 0.054822) [&95%={0.026318, 0.102212}]: 0.338107) [&95%={0.223352, 0.623891}]: 0.323888) [&95%={0.471797, 1.01507}]: 0.420952) [&95%={0.83769, 1.48094}]: 0.322677) [&95%={1.09494, 1.87523}]: 0.208231) [&95%={1.26395, 2.11713}]: 0.629306) [&95%={1.78837, 2.83498}]: 0.302461) [&95%={2.04311, 3.16224}]: 0.293003) [&95%={2.28606, 3.48309}]: 0.315761) [&95%={2.56153, 3.8111}]: 0.488836) [&95%={3.03823, 4.29376}]: 0.662338) [&95%={3.72454, 4.8508}]: 0.566664) [&95%={4.35385, 5.24204}]: 0.550392) [&95%={4.96852, 6.23052}];"
  )


## LOAD AGE DATAFRAMES
# tidy up dataframes
allTree_ages <- tidy_age_df(all_tree$nodeAges, "allTree")

noBran_ages <- tidy_age_df(noBran_tree$nodeAges, "noBran")
noAnos_ages <- tidy_age_df(noAnos_tree$nodeAges, "noAnos")
noNoto_ages <- tidy_age_df(noNoto_tree$nodeAges, "noNoto")
noClad_ages <- tidy_age_df(noClad_tree$nodeAges, "noClad")

noCladBra_ages <- tidy_age_df(noCladBra_tree$nodeAges, "noCladBra")
noCladAnos_ages <- tidy_age_df(noCladAnos_tree$nodeAges, "noCladAnos")
noCladNoto_ages <- tidy_age_df(noCladNoto_tree$nodeAges, "noCladNoto")

concGenes_ages <- tidy_age_df(concGenes_tree$nodeAges, "concGenes")
discGenes_ages <- tidy_age_df(discGenes_tree$nodeAges, "discGenes")
noLysp_ages <- tidy_age_df(noLysp_tree$nodeAges, "noLysp") %>%
  # adjust node labels to the absenc of Lysp
  mutate(Node = ifelse(Node <= 65, Node+1, Node+2))

## PLOTS SINGLE JACK-KNIFE RESULTS
# merge age dataframes
df_list_1jackknife <- list(allTree_ages,
                           noBran_ages,
                           noAnos_ages,
                           noNoto_ages,
                           noClad_ages)

# define order of panels
order_plots_1jackknife <- c("noBran", "noAnos", "noNoto", "noClad")

# define strip labels
labeller_1jackknife <- c('noBran' = "A) No Branchiopoda",
                         'noAnos' = "B) No Anostraca",
                         'noNoto' = "C) No Notostraca",
                         'noClad' = "D) No Cladocera")

# generate plot
plot_corr_1jackknife <- plot_corr(df_list_1jackknife, order_plots_1jackknife, labeller_1jackknife, 2)
plot_corr_1jackknife


## PLOTS DOUBLE JACK-KNIFE RESULTS
# merge age dataframes
df_list_2jackknife <- list(allTree_ages,
                           noCladBra_ages,
                           noCladAnos_ages,
                           noCladNoto_ages)

# define order of panels
order_plots_2jackknife <- c("noCladBra", "noCladAnos", "noCladNoto", "uniform")

# define strip labels
labeller_2jackknife <- c('noCladBra' = "A) No Branchiopoda no Cladocera",
                         'noCladAnos' = "B) No Anostraca no Cladocera",
                         'noCladNoto' = "C) No Notostraca no Cladocera")

# generate plot
plot_corr_2jackknife <- plot_corr(df_list_2jackknife, order_plots_2jackknife, labeller_2jackknife, 1)
plot_corr_2jackknife

# # BIG PLOT
# df_list_big <- c(df_list_1jackknife, df_list_2jackknife[-1])
# 
# order_plots_big <- c(order_plots_1jackknife, order_plots_2jackknife)
# 
# labeller_big <- c('noBran' = "A) No Branchiopoda",
#                   'noAnos' = "B) No Anostraca",
#                   'noNoto' = "C) No Notostraca",
#                   'noClad' = "D) No Cladocera",
#                   'noCladBra' = "E) No Branchiopoda no Cladocea",
#                   'noCladAnos' = "F) No Anostraca no Cladocera",
#                   'noCladNoto' = "G) No Notostraca no Cladocea")
# 
# plot_big <- plot_corr(df_list_big, order_plots_big, labeller_big, 2)
# plot_big

## PLOTS SUBSETS RESULTS
# merge age dataframes
df_list_subsets <- list(allTree_ages,
                        concGenes_ages,
                        discGenes_ages,
                        noLysp_ages)

# define order of panels
order_plots_subsets <- c("noLysp", "concGenes", "discGenes")

# define strip labels
labeller_subsets <- c('noLysp' = "A) No Lynceus sp.",
                      'concGenes' = "B) Concordant genes",
                      'discGenes' = "C) Discordant genes")

# generate plot
plot_corr_subsets <- plot_corr(df_list_subsets, order_plots_subsets, labeller_subsets, 1)
plot_corr_subsets


########################
#     SAVE RESULTS     #
########################

ggsave("figure_3.png",
       plot = plot_corr_1jackknife, device = "png",
       dpi = 300, height = 8, width = 8, units = ("in"), bg = 'white')

ggsave("supp_figure_S3.png",
       plot = plot_corr_2jackknife, device = "png",
       dpi = 300, height = 4, width = 12, units = ("in"), bg = 'white')

ggsave("supp_figure_S4.png",
       plot = plot_corr_subsets, device = "png",
       dpi = 300, height = 4, width = 12, units = ("in"), bg = 'white')

# ggsave("plot_big.png",
#        plot = plot_big, device = "png",
#        dpi = 300, height = 8, width = 12, units = ("in"), bg = 'white')


