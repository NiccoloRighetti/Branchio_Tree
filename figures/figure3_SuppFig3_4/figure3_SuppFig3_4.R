suppressWarnings({
  library(MCMCtreeR)
  library(ggplot2)
  library(tidyverse)
  })

#####################
#     FUNCTIONS     #
#####################

generate_MCMCtree_object <- function(tree) {
  tree_nexus <- as.character(c("#NEXUS",
                               "begin trees",
                               "",
                               tree,
                               "END;"))
  
  mcmctree_object <- readMCMCtree(tree_nexus, from.file = FALSE)
  
  return(mcmctree_object)
}

tidy_age_df <- function(df, group) {
  colnames(df) <- paste0(group, "_", sub("95%_", "CI", colnames(df)))
  
  df <- as.data.frame(df) %>%
    tibble::rownames_to_column("Node") %>%
    mutate_if(is.numeric, ~ . * 100)
  
  df$Node <- as.numeric(df$Node)
  
  return(df)
}


plot_corr <- function(list_to_plot, order_panel, labeller, n_row) {
  
  # remove redundant columns and outgroup nodes
  dates <- list_to_plot %>%
    reduce(full_join, by = "Node") %>%
    filter(Node > 50)
  
  dates
  
  # prepare tibble for ggplot
  tibble_to_plot <- dates %>%
    
    pivot_longer(cols = -c(Node, allTree_mean, allTree_CIlower, allTree_CIupper),
                 names_to = c("tree", "metric"),
                 names_sep = "_",
                 values_to = "age") %>%
    
    pivot_wider(names_from = metric,
                values_from = age) %>%
    
    mutate(calibration = if_else(Node %in% c(51, 52, 58, 81), "calib", "uncalib")) %>%
    mutate(label = case_when(Node == 51 ~ "1",
                             Node == 52 ~ "2",
                             Node == 58 ~ "3",
                             Node == 81 ~ "4",
                             Node == 57 ~ "Ph",
                             Node == 67 ~ "Dp",
                             Node == 68 ~ "Oc",
                             Node == 79 ~ "Cm",
                             Node == 83 ~ "Op",
                             Node == 85 ~ "An",
                             TRUE ~ ""))
  
  tibble_to_plot
  tibble_to_plot$tree <- factor(tibble_to_plot$tree,
                                levels = order_panel)
  
  plot <- ggplot(tibble_to_plot, aes(x = allTree_mean, y = mean, label = as.factor(label))) +
    
    geom_abline(intercept = 0, slope = 1, linewidth = 0.5) +
    
    # regression line
    geom_smooth(method = "lm", linewidth = 0.8, col = "grey80", fill = alpha("grey80", 0.3)) +
    
    # error bars
    geom_errorbar(aes(xmin = allTree_CIlower, xmax = allTree_CIupper, linewidth = calibration, col = calibration),
                  lineend = "round") +
    geom_errorbar(aes(ymin = CIlower, ymax = CIupper, linewidth = calibration, col = calibration),
                  lineend = "round") +
    
    scale_color_manual(values = c("#ffbbc6", "#b5c4ff")) +
    scale_discrete_manual("linewidth", values = c(1.3, 0.7)) +
    
    # scatterplot
    ggnewscale::new_scale_color() +
    geom_point(aes(col = calibration, size = calibration, stroke = calibration), shape = 1) +
    
    scale_color_manual(values = c("#ff3657", "#2552ff")) +
    scale_size_manual(values = c(2, 1)) +
    scale_discrete_manual("stroke", values = c(1.5, 0.9)) +
    
    ggpubr::stat_cor(method = "pearson", size = 4) +
    
    # node labels
    ggrepel::geom_text_repel(col = "#3d3d3d", force = 20,
                             min.segment.length = 0, box.padding = 0.5, max.overlaps = Inf) +
    
    scale_y_continuous(limits = c(0, max(tibble_to_plot$CIupper))) +
    
    facet_wrap(~tree, scales = "free", labeller = as_labeller(labeller), nrow = n_row) +
    
    xlab("Age (Ma)") +
    ylab("Age (Ma)") +
    
    theme_minimal() +
    theme(aspect.ratio = 1,
          strip.text = element_text(face = "bold", hjust = 0),
          panel.grid.minor.y = element_blank(),
          panel.grid.minor.x = element_blank(),
          axis.line = element_line(linewidth = 0.5),
          axis.text.y = element_text(size = 8),
          axis.title = element_text(size = 8, face = "bold"),
          strip.placement = "outside",
          legend.position = "none")
  
  return(plot)
}

#######################
#     ACTUAL CODE     #
#######################

## LOAD TREES

# all fossils all calibs
all_tree <- generate_MCMCtree_object(
  "((Scur: 4.848493, Iele: 4.848493) [&95%={3.81246, 5.69126}]: 0.324486, (((Blyn: 0.183483, Blin: 0.183483) [&95%={0.0847524, 0.349781}]: 1.091604, (Afr1: 1.053374, (Bher: 0.741404, (Stsp: 0.599355, Tpla: 0.599355) [&95%={0.385747, 0.817728}]: 0.142049) [&95%={0.52585, 0.944749}]: 0.311971) [&95%={0.870009, 1.18177}]: 0.221713) [&95%={1.25791, 1.30601}]: 2.790971, (((Tlon: 0.459209, (Tces: 0.042333, (Tcit: 0.004908, Tcjp: 0.004908) [&95%={0.0022087, 0.0097336}]: 0.037426) [&95%={0.0206915, 0.0803842}]: 0.416876) [&95%={0.222185, 0.809971}]: 0.772728, ((Lcry: 0.075381, Lpac: 0.075381) [&95%={0.0350263, 0.140941}]: 0.164834, (Lubb: 0.087096, (Lapu: 0.072839, (Lcou: 0.036019, Lart: 0.036019) [&95%={0.0183237, 0.0626149}]: 0.036820) [&95%={0.0440445, 0.113719}]: 0.014257) [&95%={0.055115, 0.131698}]: 0.153118) [&95%={0.145528, 0.39566}]: 0.991722) [&95%={1.21848, 1.25871}]: 2.216226, (Lysp: 2.978259, (((Orub: 0.372016, (Ozsp: 0.300488, Cpil: 0.300488) [&95%={0.152237, 0.534596}]: 0.071528) [&95%={0.211772, 0.619124}]: 1.024664, ((Eosp: 0.951087, (Ldah: 0.493508, Etic: 0.493508) [&95%={0.265791, 0.788934}]: 0.457579) [&95%={0.672564, 1.26007}]: 0.203246, ((Mesp: 0.397918, Etex: 0.397918) [&95%={0.20474, 0.663208}]: 0.425019, (Puru: 0.376573, (Lpar: 0.197297, Lbir: 0.197297) [&95%={0.0980009, 0.346929}]: 0.179276) [&95%={0.226598, 0.587721}]: 0.446364) [&95%={0.574762, 1.13005}]: 0.331396) [&95%={0.886453, 1.49986}]: 0.242347) [&95%={1.08254, 1.80194}]: 1.154947, ((Chis: 0.525988, C146: 0.525988) [&95%={0.237675, 0.991174}]: 1.529127, (Scry: 1.746552, ((Pped: 1.159143, (Pleu: 0.661385, Enor: 0.661385) [&95%={0.372042, 0.985747}]: 0.497758) [&95%={0.85386, 1.41609}]: 0.433512, ((Bosp: 1.006935, (Elam: 0.145816, Aema: 0.145816) [&95%={0.0676681, 0.274699}]: 0.861119) [&95%={0.673296, 1.26163}]: 0.412320, (Mosp: 1.094142, (Masp: 0.966069, ((Cqua: 0.614324, (Svet: 0.224113, Smuc: 0.224113) [&95%={0.117718, 0.372385}]: 0.390211) [&95%={0.438641, 0.808974}]: 0.153198, (Dmag: 0.492747, (Dgal: 0.272179, (Dpul: 0.039349, Dpli: 0.039349) [&95%={0.0183865, 0.0755922}]: 0.232831) [&95%={0.152902, 0.435399}]: 0.220567) [&95%={0.332394, 0.690697}]: 0.274775) [&95%={0.592739, 0.958237}]: 0.198547) [&95%={0.773892, 1.15275}]: 0.128074) [&95%={0.894723, 1.26377}]: 0.325113) [&95%={1.23094, 1.55686}]: 0.173400) [&95%={1.44829, 1.68431}]: 0.153897) [&95%={1.73162, 1.77298}]: 0.308563) [&95%={1.85787, 2.38454}]: 0.496512) [&95%={2.18149, 3.0067}]: 0.426632) [&95%={2.51761, 3.4421}]: 0.469904) [&95%={2.95025, 3.83046}]: 0.617896) [&95%={4.05064, 4.09476}]: 1.106920) [&95%={4.88981, 5.85287}];"
  )

# no branchiopoda
noBran_tree <- generate_MCMCtree_object(
  "((Scur: 4.748362, Iele: 4.748362) [&95%={3.55806, 5.65411}]: 0.444332, (((Blyn: 0.187378, Blin: 0.187378) [&95%={0.0849576, 0.36114}]: 1.087722, (Afr1: 1.054286, (Bher: 0.743175, (Stsp: 0.599877, Tpla: 0.599877) [&95%={0.384273, 0.817321}]: 0.143298) [&95%={0.527007, 0.950342}]: 0.311112) [&95%={0.872709, 1.18331}]: 0.220814) [&95%={1.25794, 1.30551}]: 3.068230, (((Tlon: 0.461486, (Tces: 0.043209, (Tcit: 0.004971, Tcjp: 0.004971) [&95%={0.0022139, 0.0098688}]: 0.038238) [&95%={0.0208104, 0.0825883}]: 0.418277) [&95%={0.222255, 0.814338}]: 0.770470, ((Lcry: 0.075536, Lpac: 0.075536) [&95%={0.0353283, 0.142348}]: 0.166595, (Lubb: 0.088310, (Lapu: 0.073799, (Lcou: 0.036239, Lart: 0.036239) [&95%={0.0184033, 0.0642897}]: 0.037560) [&95%={0.0443384, 0.118358}]: 0.014511) [&95%={0.0554089, 0.137542}]: 0.153821) [&95%={0.147158, 0.401352}]: 0.989824) [&95%={1.21848, 1.25877}]: 2.360879, (Lysp: 3.069667, (((Orub: 0.374580, (Ozsp: 0.301815, Cpil: 0.301815) [&95%={0.152702, 0.534981}]: 0.072766) [&95%={0.211537, 0.622832}]: 1.031631, ((Eosp: 0.954492, (Ldah: 0.496391, Etic: 0.496391) [&95%={0.263513, 0.790898}]: 0.458100) [&95%={0.674192, 1.2658}]: 0.204458, ((Mesp: 0.403270, Etex: 0.403270) [&95%={0.205137, 0.665288}]: 0.422549, (Puru: 0.381664, (Lpar: 0.199011, Lbir: 0.199011) [&95%={0.0976003, 0.353158}]: 0.182653) [&95%={0.226929, 0.601758}]: 0.444155) [&95%={0.578793, 1.12915}]: 0.333131) [&95%={0.885877, 1.50289}]: 0.247261) [&95%={1.08526, 1.81599}]: 1.192598, ((Chis: 0.533622, C146: 0.533622) [&95%={0.251843, 0.988505}]: 1.534052, (Scry: 1.746581, ((Pped: 1.154007, (Pleu: 0.651682, Enor: 0.651682) [&95%={0.363128, 0.974105}]: 0.502326) [&95%={0.837092, 1.41426}]: 0.437185, ((Bosp: 1.001406, (Elam: 0.147886, Aema: 0.147886) [&95%={0.0680121, 0.280208}]: 0.853520) [&95%={0.672175, 1.26291}]: 0.417061, (Mosp: 1.096315, (Masp: 0.967769, ((Cqua: 0.615444, (Svet: 0.226685, Smuc: 0.226685) [&95%={0.119554, 0.375074}]: 0.388759) [&95%={0.435096, 0.811565}]: 0.154512, (Dmag: 0.494330, (Dgal: 0.272153, (Dpul: 0.039588, Dpli: 0.039588) [&95%={0.01793, 0.0765339}]: 0.232565) [&95%={0.149415, 0.436829}]: 0.222177) [&95%={0.327946, 0.687829}]: 0.275626) [&95%={0.595735, 0.962069}]: 0.197813) [&95%={0.776832, 1.15585}]: 0.128546) [&95%={0.89989, 1.26624}]: 0.322152) [&95%={1.22607, 1.55865}]: 0.172725) [&95%={1.44159, 1.68244}]: 0.155388) [&95%={1.7317, 1.77346}]: 0.321093) [&95%={1.85519, 2.4562}]: 0.531135) [&95%={2.17524, 3.22014}]: 0.470858) [&95%={2.5001, 3.84369}]: 0.523168) [&95%={2.89663, 4.44238}]: 0.750496) [&95%={3.45657, 5.24136}]: 0.849363) [&95%={4.89677, 5.88987}];"
  )

# no anostraca
noAnos_tree <- generate_MCMCtree_object(
  "((Scur: 4.847654, Iele: 4.847654) [&95%={3.78012, 5.6864}]: 0.332327, (((Blyn: 0.196926, Blin: 0.196926) [&95%={0.0895838, 0.382144}]: 1.503277, (Afr1: 1.360335, (Bher: 0.918509, (Stsp: 0.752524, Tpla: 0.752524) [&95%={0.44152, 1.11529}]: 0.165985) [&95%={0.589823, 1.28465}]: 0.441826) [&95%={0.940416, 1.92559}]: 0.339868) [&95%={1.19414, 2.41336}]: 2.365952, (((Tlon: 0.476667, (Tces: 0.044168, (Tcit: 0.005081, Tcjp: 0.005081) [&95%={0.0023315, 0.0098643}]: 0.039087) [&95%={0.0217414, 0.0833259}]: 0.432500) [&95%={0.240143, 0.817759}]: 0.756201, ((Lcry: 0.077535, Lpac: 0.077535) [&95%={0.0363409, 0.144262}]: 0.171231, (Lubb: 0.090282, (Lapu: 0.075588, (Lcou: 0.037282, Lart: 0.037282) [&95%={0.0192191, 0.064993}]: 0.038306) [&95%={0.0458805, 0.119072}]: 0.014694) [&95%={0.0571041, 0.137052}]: 0.158483) [&95%={0.150745, 0.407278}]: 0.984103) [&95%={1.21855, 1.26075}]: 2.234118, (Lysp: 2.999641, (((Orub: 0.386785, (Ozsp: 0.312971, Cpil: 0.312971) [&95%={0.160381, 0.549086}]: 0.073814) [&95%={0.219266, 0.64007}]: 1.074789, ((Eosp: 0.993967, (Ldah: 0.517405, Etic: 0.517405) [&95%={0.273977, 0.825345}]: 0.476562) [&95%={0.70124, 1.32631}]: 0.209403, ((Mesp: 0.412318, Etex: 0.412318) [&95%={0.212911, 0.678204}]: 0.442334, (Puru: 0.390161, (Lpar: 0.202751, Lbir: 0.202751) [&95%={0.101109, 0.353611}]: 0.187409) [&95%={0.234625, 0.607989}]: 0.464491) [&95%={0.595803, 1.16891}]: 0.348718) [&95%={0.91103, 1.54714}]: 0.258204) [&95%={1.1111, 1.83844}]: 1.109260, ((Chis: 0.541709, C146: 0.541709) [&95%={0.258674, 0.985609}]: 1.524163, (Scry: 1.746819, ((Pped: 1.163081, (Pleu: 0.662344, Enor: 0.662344) [&95%={0.373642, 0.989155}]: 0.500738) [&95%={0.858004, 1.43684}]: 0.435438, ((Bosp: 1.008221, (Elam: 0.150632, Aema: 0.150632) [&95%={0.0707006, 0.280742}]: 0.857589) [&95%={0.691327, 1.2547}]: 0.422690, (Mosp: 1.099193, (Masp: 0.970071, ((Cqua: 0.616963, (Svet: 0.230944, Smuc: 0.230944) [&95%={0.123421, 0.380461}]: 0.386020) [&95%={0.445162, 0.795219}]: 0.155725, (Dmag: 0.498532, (Dgal: 0.277293, (Dpul: 0.040688, Dpli: 0.040688) [&95%={0.0189193, 0.0771872}]: 0.236605) [&95%={0.155563, 0.439527}]: 0.221239) [&95%={0.332249, 0.682149}]: 0.274156) [&95%={0.605457, 0.94572}]: 0.197383) [&95%={0.789679, 1.13939}]: 0.129122) [&95%={0.914679, 1.26343}]: 0.331718) [&95%={1.26151, 1.55687}]: 0.167609) [&95%={1.47401, 1.6832}]: 0.148299) [&95%={1.7317, 1.77374}]: 0.319054) [&95%={1.86288, 2.40781}]: 0.504962) [&95%={2.2032, 3.02453}]: 0.428807) [&95%={2.54627, 3.4497}]: 0.467345) [&95%={2.98242, 3.82823}]: 0.599168) [&95%={4.05061, 4.09556}]: 1.113826) [&95%={4.89439, 5.86813}];"
  )

# no notostraca
noNoto_tree <- generate_MCMCtree_object(
  "((Scur: 4.859456, Iele: 4.859456) [&95%={3.87663, 5.68594}]: 0.304073, (((Blyn: 0.179697, Blin: 0.179697) [&95%={0.0841039, 0.3366}]: 1.093567, (Afr1: 1.052496, (Bher: 0.739346, (Stsp: 0.599299, Tpla: 0.599299) [&95%={0.388255, 0.813841}]: 0.140046) [&95%={0.523262, 0.940544}]: 0.313150) [&95%={0.877232, 1.17865}]: 0.220769) [&95%={1.25776, 1.30244}]: 2.792747, (((Tlon: 0.400053, (Tces: 0.040981, (Tcit: 0.004768, Tcjp: 0.004768) [&95%={0.0021867, 0.0092884}]: 0.036213) [&95%={0.020224, 0.0765809}]: 0.359072) [&95%={0.204966, 0.705432}]: 0.548803, ((Lcry: 0.072309, Lpac: 0.072309) [&95%={0.0343432, 0.135834}]: 0.153248, (Lubb: 0.083997, (Lapu: 0.070239, (Lcou: 0.034699, Lart: 0.034699) [&95%={0.0178516, 0.0609236}]: 0.035540) [&95%={0.0426431, 0.110906}]: 0.013758) [&95%={0.0533793, 0.128482}]: 0.141561) [&95%={0.139314, 0.36252}]: 0.723299) [&95%={0.588157, 1.43317}]: 2.480627, (Lysp: 2.961370, (((Orub: 0.363628, (Ozsp: 0.294233, Cpil: 0.294233) [&95%={0.153169, 0.510113}]: 0.069395) [&95%={0.208362, 0.590273}]: 1.006995, ((Eosp: 0.936951, (Ldah: 0.486728, Etic: 0.486728) [&95%={0.260819, 0.778396}]: 0.450223) [&95%={0.662854, 1.24975}]: 0.197000, ((Mesp: 0.391813, Etex: 0.391813) [&95%={0.20285, 0.653078}]: 0.417109, (Puru: 0.369165, (Lpar: 0.191790, Lbir: 0.191790) [&95%={0.0968816, 0.338535}]: 0.177375) [&95%={0.221296, 0.579144}]: 0.439758) [&95%={0.564243, 1.11773}]: 0.325029) [&95%={0.869238, 1.47934}]: 0.236672) [&95%={1.06172, 1.74811}]: 1.168012, ((Chis: 0.517577, C146: 0.517577) [&95%={0.241301, 0.964638}]: 1.531708, (Scry: 1.746420, ((Pped: 1.148341, (Pleu: 0.647602, Enor: 0.647602) [&95%={0.360166, 0.972043}]: 0.500740) [&95%={0.834949, 1.41939}]: 0.441061, ((Bosp: 0.999821, (Elam: 0.142446, Aema: 0.142446) [&95%={0.0671551, 0.267295}]: 0.857375) [&95%={0.674537, 1.25717}]: 0.414252, (Mosp: 1.080786, (Masp: 0.953544, ((Cqua: 0.607117, (Svet: 0.220062, Smuc: 0.220062) [&95%={0.116699, 0.359375}]: 0.387054) [&95%={0.433115, 0.794284}]: 0.150629, (Dmag: 0.488156, (Dgal: 0.268929, (Dpul: 0.038298, Dpli: 0.038298) [&95%={0.0177627, 0.0727656}]: 0.230631) [&95%={0.149582, 0.427546}]: 0.219227) [&95%={0.326194, 0.670914}]: 0.269589) [&95%={0.584769, 0.936726}]: 0.195798) [&95%={0.762244, 1.13185}]: 0.127242) [&95%={0.887479, 1.25216}]: 0.333287) [&95%={1.22142, 1.5554}]: 0.175330) [&95%={1.44469, 1.6814}]: 0.157017) [&95%={1.73164, 1.7731}]: 0.302866) [&95%={1.85744, 2.37993}]: 0.489350) [&95%={2.16962, 3.00018}]: 0.422735) [&95%={2.50211, 3.43468}]: 0.468114) [&95%={2.91717, 3.82414}]: 0.636528) [&95%={4.05063, 4.09593}]: 1.097518) [&95%={4.88978, 5.85122}];"
  )

# no cladocera
noClad_tree <- generate_MCMCtree_object(
  "((Scur: 4.819732, Iele: 4.819732) [&95%={3.69816, 5.69633}]: 0.357624, (((Blyn: 0.193876, Blin: 0.193876) [&95%={0.0934429, 0.360428}]: 1.081683, (Afr1: 1.056880, (Bher: 0.749357, (Stsp: 0.604184, Tpla: 0.604184) [&95%={0.396935, 0.80743}]: 0.145173) [&95%={0.54445, 0.942273}]: 0.307523) [&95%={0.889662, 1.17882}]: 0.218679) [&95%={1.25791, 1.30646}]: 2.790837, (((Tlon: 0.475831, (Tces: 0.045185, (Tcit: 0.005194, Tcjp: 0.005194) [&95%={0.0024441, 0.0098274}]: 0.039991) [&95%={0.0227574, 0.0836635}]: 0.430646) [&95%={0.240155, 0.808336}]: 0.757027, ((Lcry: 0.079501, Lpac: 0.079501) [&95%={0.0383345, 0.145855}]: 0.173999, (Lubb: 0.092500, (Lapu: 0.077559, (Lcou: 0.038148, Lart: 0.038148) [&95%={0.0199037, 0.0653943}]: 0.039411) [&95%={0.0476088, 0.121559}]: 0.014941) [&95%={0.0595605, 0.140395}]: 0.161000) [&95%={0.15616, 0.413204}]: 0.979358) [&95%={1.2185, 1.26069}]: 2.371995, (Lysp: 3.230609, (((Orub: 0.394610, (Ozsp: 0.319921, Cpil: 0.319921) [&95%={0.168101, 0.550784}]: 0.074689) [&95%={0.22754, 0.641185}]: 1.081407, ((Eosp: 0.988842, (Ldah: 0.518593, Etic: 0.518593) [&95%={0.283269, 0.818472}]: 0.470248) [&95%={0.709272, 1.28882}]: 0.212427, ((Mesp: 0.421812, Etex: 0.421812) [&95%={0.226592, 0.686651}]: 0.439669, (Puru: 0.395413, (Lpar: 0.206463, Lbir: 0.206463) [&95%={0.106395, 0.357154}]: 0.188950) [&95%={0.241779, 0.610601}]: 0.466068) [&95%={0.610853, 1.19587}]: 0.339788) [&95%={0.928745, 1.60859}]: 0.274749) [&95%={1.13314, 2.01544}]: 1.405970, ((Chis: 0.574524, C146: 0.574524) [&95%={0.271088, 1.05137}]: 1.915827, (Scry: 2.231680, ((Pped: 1.359800, (Pleu: 0.755470, Enor: 0.755470) [&95%={0.413223, 1.21461}]: 0.604330) [&95%={0.956251, 1.9018}]: 0.641021, ((Bosp: 1.170081, (Elam: 0.157950, Aema: 0.157950) [&95%={0.0752934, 0.294897}]: 1.012131) [&95%={0.79189, 1.60946}]: 0.585590, (Mosp: 1.249093, (Masp: 1.097723, ((Cqua: 0.694147, (Svet: 0.247142, Smuc: 0.247142) [&95%={0.132948, 0.404775}]: 0.447005) [&95%={0.492841, 0.913329}]: 0.171277, (Dmag: 0.549615, (Dgal: 0.300322, (Dpul: 0.041982, Dpli: 0.041982) [&95%={0.019687, 0.0800865}]: 0.258340) [&95%={0.169869, 0.477665}]: 0.249293) [&95%={0.373835, 0.758484}]: 0.315810) [&95%={0.671266, 1.08356}]: 0.232298) [&95%={0.892932, 1.31465}]: 0.151371) [&95%={1.03865, 1.52516}]: 0.506578) [&95%={1.44989, 2.11859}]: 0.245149) [&95%={1.66145, 2.38116}]: 0.230859) [&95%={1.86363, 2.63075}]: 0.258670) [&95%={2.09524, 2.89696}]: 0.391637) [&95%={2.46323, 3.27024}]: 0.348621) [&95%={2.81153, 3.58589}]: 0.374245) [&95%={3.21757, 3.87592}]: 0.461543) [&95%={4.0506, 4.0951}]: 1.110959) [&95%={4.89234, 5.87671}];"
  )

# no cladocera no branchiopoda
noCladBra_tree <- generate_MCMCtree_object(
  "((Scur: 4.283666, Iele: 4.283666) [&95%={3.1474, 5.05124}]: 0.671738, (((Blyn: 0.200801, Blin: 0.200801) [&95%={0.0961918, 0.371696}]: 1.075053, (Afr1: 1.058055, (Bher: 0.753090, (Stsp: 0.605735, Tpla: 0.605735) [&95%={0.402429, 0.807445}]: 0.147355) [&95%={0.551531, 0.942067}]: 0.304965) [&95%={0.892718, 1.17731}]: 0.217799) [&95%={1.25788, 1.30691}]: 3.253509, (((Tlon: 0.489852, (Tita: 0.046907, (Tusa: 0.005405, Tjap: 0.005405) [&95%={0.0025142, 0.0104547}]: 0.041502) [&95%={0.0231903, 0.0869514}]: 0.442945) [&95%={0.251156, 0.825523}]: 0.743141, ((Lcry: 0.082458, Lpac: 0.082458) [&95%={0.0394835, 0.152703}]: 0.179344, (Lubb: 0.096095, (Lapu: 0.080490, (Lcou: 0.039750, Lart: 0.039750) [&95%={0.020501, 0.0692897}]: 0.040740) [&95%={0.0487865, 0.128666}]: 0.015605) [&95%={0.0612142, 0.148386}]: 0.165708) [&95%={0.161243, 0.424769}]: 0.971190) [&95%={1.21856, 1.26058}]: 2.728279, (Lysp: 3.524155, (((Orub: 0.411243, (Ozsp: 0.333437, Cpil: 0.333437) [&95%={0.173843, 0.584693}]: 0.077806) [&95%={0.237658, 0.676231}]: 1.144000, ((Eosp: 1.031829, (Ldah: 0.542767, Etic: 0.542767) [&95%={0.292301, 0.870004}]: 0.489063) [&95%={0.724189, 1.41369}]: 0.224911, ((Mesp: 0.438368, Etex: 0.438368) [&95%={0.228783, 0.720198}]: 0.457664, (Puru: 0.411190, (Lpar: 0.214118, Lbir: 0.214118) [&95%={0.108641, 0.37357}]: 0.197072) [&95%={0.247827, 0.636325}]: 0.484842) [&95%={0.622992, 1.25038}]: 0.360708) [&95%={0.948606, 1.73182}]: 0.298503) [&95%={1.15176, 2.18187}]: 1.567687, ((Chis: 0.598011, C146: 0.598011) [&95%={0.28161, 1.12854}]: 2.078955, (Scry: 2.389062, ((Pped: 1.463967, (Pleu: 0.806626, Enor: 0.806626) [&95%={0.423408, 1.26061}]: 0.657341) [&95%={0.981004, 2.11277}]: 0.672538, ((Bosp: 1.225987, (Elam: 0.163860, Aema: 0.163860) [&95%={0.0779498, 0.308005}]: 1.062127) [&95%={0.811116, 1.80692}]: 0.642996, (Mosp: 1.305747, (Masp: 1.143496, ((Cqua: 0.723549, (Svet: 0.258769, Smuc: 0.258769) [&95%={0.138834, 0.427185}]: 0.464780) [&95%={0.515564, 0.992409}]: 0.177189, (Dmag: 0.571968, (Dgal: 0.312422, (Dpul: 0.043587, Dpli: 0.043587) [&95%={0.0205531, 0.0813052}]: 0.268835) [&95%={0.173681, 0.507788}]: 0.259547) [&95%={0.381054, 0.814923}]: 0.328770) [&95%={0.687721, 1.20012}]: 0.242757) [&95%={0.911688, 1.52448}]: 0.162252) [&95%={1.05485, 1.73418}]: 0.563235) [&95%={1.48679, 2.39023}]: 0.267523) [&95%={1.70948, 2.67764}]: 0.252557) [&95%={1.9178, 2.96471}]: 0.287904) [&95%={2.16287, 3.28114}]: 0.445964) [&95%={2.55244, 3.7564}]: 0.401225) [&95%={2.90326, 4.16742}]: 0.437116) [&95%={3.29686, 4.58754}]: 0.568092) [&95%={3.85372, 5.08064}]: 0.426041) [&95%={4.74017, 5.28122}];"
)

# no cladocera no anostraca
noCladAnos_tree <- generate_MCMCtree_object(
  "((Scur: 4.451661, Iele: 4.451661) [&95%={3.43779, 5.12182}]: 0.468236, (((Blyn: 0.214850, Blin: 0.214850) [&95%={0.103336, 0.400151}]: 1.797154, (Afr1: 1.611888, (Bher: 1.035494, (Stsp: 0.852149, Tpla: 0.852149) [&95%={0.505753, 1.21687}]: 0.183345) [&95%={0.663892, 1.45963}]: 0.576394) [&95%={1.04481, 2.26233}]: 0.400117) [&95%={1.33898, 2.73367}]: 2.054747, (((Tlon: 0.498873, (Tita: 0.047937, (Tusa: 0.005539, Tjap: 0.005539) [&95%={0.0026469, 0.01039}]: 0.042399) [&95%={0.0245342, 0.0876967}]: 0.450936) [&95%={0.264214, 0.812822}]: 0.735037, ((Lcry: 0.084183, Lpac: 0.084183) [&95%={0.041524, 0.151098}]: 0.182619, (Lubb: 0.098344, (Lapu: 0.082581, (Lcou: 0.040839, Lart: 0.040839) [&95%={0.0216588, 0.0696904}]: 0.041742) [&95%={0.0514877, 0.127373}]: 0.015763) [&95%={0.0638133, 0.147021}]: 0.168459) [&95%={0.166737, 0.423229}]: 0.967109) [&95%={1.2186, 1.26281}]: 2.411654, (Lysp: 3.294970, (((Orub: 0.424463, (Ozsp: 0.345367, Cpil: 0.345367) [&95%={0.187409, 0.586807}]: 0.079095) [&95%={0.252341, 0.679492}]: 1.192716, ((Eosp: 1.070087, (Ldah: 0.560483, Etic: 0.560483) [&95%={0.311038, 0.895117}]: 0.509604) [&95%={0.753565, 1.51923}]: 0.237027, ((Mesp: 0.448163, Etex: 0.448163) [&95%={0.239215, 0.729232}]: 0.475529, (Puru: 0.424527, (Lpar: 0.222742, Lbir: 0.222742) [&95%={0.117191, 0.381469}]: 0.201785) [&95%={0.258954, 0.654733}]: 0.499165) [&95%={0.646526, 1.23411}]: 0.383421) [&95%={0.971539, 1.77939}]: 0.310065) [&95%={1.16546, 2.17207}]: 1.348357, ((Chis: 0.601413, C146: 0.601413) [&95%={0.292009, 1.05969}]: 1.986759, (Scry: 2.331668, ((Pped: 1.493122, (Pleu: 0.816843, Enor: 0.816843) [&95%={0.447781, 1.22166}]: 0.676279) [&95%={0.994928, 2.02965}]: 0.607333, ((Bosp: 1.233632, (Elam: 0.166477, Aema: 0.166477) [&95%={0.0823091, 0.301019}]: 1.067156) [&95%={0.816196, 1.76124}]: 0.614261, (Mosp: 1.314577, (Masp: 1.150684, ((Cqua: 0.727747, (Svet: 0.263471, Smuc: 0.263471) [&95%={0.144438, 0.432222}]: 0.464276) [&95%={0.515452, 0.986207}]: 0.179464, (Dmag: 0.579873, (Dgal: 0.319217, (Dpul: 0.044721, Dpli: 0.044721) [&95%={0.0218614, 0.0830438}]: 0.274496) [&95%={0.182648, 0.507385}]: 0.260656) [&95%={0.390809, 0.817136}]: 0.327338) [&95%={0.694923, 1.18022}]: 0.243473) [&95%={0.909796, 1.50383}]: 0.163893) [&95%={1.05396, 1.68687}]: 0.533316) [&95%={1.49548, 2.24693}]: 0.252562) [&95%={1.72129, 2.50407}]: 0.231213) [&95%={1.93306, 2.73475}]: 0.256503) [&95%={2.16717, 2.98952}]: 0.377365) [&95%={2.545, 3.33347}]: 0.329434) [&95%={2.88996, 3.61423}]: 0.350594) [&95%={3.29249, 3.881}]: 0.421187) [&95%={4.05073, 4.09657}]: 0.853145) [&95%={4.73478, 5.26452}];"
)

# no cladocera no notostraca
noCladNoto_tree <- generate_MCMCtree_object(
  "((Scur: 4.529522, Iele: 4.529522) [&95%={3.56631, 5.12932}]: 0.382319, (((Blyn: 0.187291, Blin: 0.187291) [&95%={0.0894196, 0.344991}]: 1.087301, (Afr1: 1.056710, (Bher: 0.748790, (Stsp: 0.607120, Tpla: 0.607120) [&95%={0.401253, 0.809277}]: 0.141671) [&95%={0.545384, 0.93882}]: 0.307919) [&95%={0.891702, 1.17599}]: 0.217882) [&95%={1.25791, 1.30468}]: 2.791723, (((Tlon: 0.412328, (Tita: 0.042894, (Tusa: 0.004966, Tjap: 0.004966) [&95%={0.0023415, 0.0094057}]: 0.037928) [&95%={0.0216929, 0.0780731}]: 0.369434) [&95%={0.217251, 0.702114}]: 0.561680, ((Lcry: 0.075594, Lpac: 0.075594) [&95%={0.0366902, 0.136797}]: 0.160305, (Lubb: 0.088107, (Lapu: 0.073922, (Lcou: 0.036623, Lart: 0.036623) [&95%={0.0194985, 0.0628413}]: 0.037299) [&95%={0.0460155, 0.113936}]: 0.014185) [&95%={0.0570277, 0.132148}]: 0.147792) [&95%={0.147906, 0.3717}]: 0.738108) [&95%={0.63117, 1.371}]: 2.608410, (Lysp: 3.199548, (((Orub: 0.378754, (Ozsp: 0.307155, Cpil: 0.307155) [&95%={0.162592, 0.5245}]: 0.071599) [&95%={0.221171, 0.612618}]: 1.038044, ((Eosp: 0.956738, (Ldah: 0.501540, Etic: 0.501540) [&95%={0.279372, 0.786026}]: 0.455198) [&95%={0.69149, 1.253}]: 0.201247, ((Mesp: 0.403189, Etex: 0.403189) [&95%={0.219201, 0.648907}]: 0.423549, (Puru: 0.379005, (Lpar: 0.198010, Lbir: 0.198010) [&95%={0.103669, 0.339938}]: 0.180995) [&95%={0.23259, 0.581793}]: 0.447732) [&95%={0.592219, 1.11465}]: 0.331248) [&95%={0.901411, 1.52549}]: 0.258813) [&95%={1.09443, 1.92547}]: 1.428033, ((Chis: 0.552945, C146: 0.552945) [&95%={0.265018, 1.00896}]: 1.893530, (Scry: 2.187023, ((Pped: 1.333142, (Pleu: 0.732849, Enor: 0.732849) [&95%={0.397416, 1.16606}]: 0.600293) [&95%={0.930901, 1.87034}]: 0.624487, ((Bosp: 1.138751, (Elam: 0.150363, Aema: 0.150363) [&95%={0.0725613, 0.275085}]: 0.988388) [&95%={0.759859, 1.58443}]: 0.576435, (Mosp: 1.214613, (Masp: 1.067629, ((Cqua: 0.673850, (Svet: 0.239594, Smuc: 0.239594) [&95%={0.130817, 0.389116}]: 0.434256) [&95%={0.482787, 0.886147}]: 0.164812, (Dmag: 0.531943, (Dgal: 0.290280, (Dpul: 0.040250, Dpli: 0.040250) [&95%={0.0196443, 0.0748996}]: 0.250029) [&95%={0.165423, 0.459541}]: 0.241663) [&95%={0.36021, 0.730536}]: 0.306720) [&95%={0.650678, 1.04623}]: 0.228967) [&95%={0.857339, 1.28882}]: 0.146983) [&95%={0.990805, 1.49324}]: 0.500573) [&95%={1.37986, 2.09164}]: 0.242443) [&95%={1.59126, 2.36404}]: 0.229394) [&95%={1.79523, 2.60269}]: 0.259452) [&95%={2.0319, 2.86976}]: 0.398356) [&95%={2.41296, 3.25425}]: 0.354717) [&95%={2.76524, 3.56956}]: 0.382870) [&95%={3.1723, 3.8641}]: 0.483897) [&95%={4.05066, 4.0954}]: 0.845526) [&95%={4.73404, 5.25821}];"
)


# concordant genes
concGenes_tree <- generate_MCMCtree_object(
  "((Scur: 4.658176, Iele: 4.658176) [&95%={3.95461, 5.12858}]: 0.236982, (((Blyn: 0.173543, Blin: 0.173543) [&95%={0.0838993, 0.32292}]: 1.101271, (Afr1: 1.003471, (Bher: 0.695799, (Stsp: 0.573941, Tpla: 0.573941) [&95%={0.361087, 0.792994}]: 0.121858) [&95%={0.481979, 0.904594}]: 0.307672) [&95%={0.808244, 1.15212}]: 0.271343) [&95%={1.25783, 1.3051}]: 2.791608, (((Tlon: 0.436791, (Tces: 0.043290, (Tcit: 0.002767, Tcjp: 0.002767) [&95%={0.0010957, 0.0057673}]: 0.040523) [&95%={0.0212793, 0.0802606}]: 0.393501) [&95%={0.221402, 0.75786}]: 0.795011, ((Lcry: 0.063790, Lpac: 0.063790) [&95%={0.0333893, 0.11007}]: 0.084211, (Lubb: 0.083776, (Lapu: 0.068746, (Lcou: 0.038749, Lart: 0.038749) [&95%={0.0203682, 0.0660698}]: 0.029997) [&95%={0.042777, 0.105919}]: 0.015030) [&95%={0.0539207, 0.124838}]: 0.064224) [&95%={0.0981868, 0.2254}]: 1.083801) [&95%={1.21845, 1.25842}]: 2.186295, (Lysp: 2.990757, (((Orub: 0.307194, (Ozsp: 0.217296, Cpil: 0.217296) [&95%={0.113304, 0.379362}]: 0.089898) [&95%={0.180775, 0.492752}]: 1.030800, ((Eosp: 0.875298, (Ldah: 0.416615, Etic: 0.416615) [&95%={0.220141, 0.671814}]: 0.458682) [&95%={0.614497, 1.17288}]: 0.192084, ((Mesp: 0.316409, Etex: 0.316409) [&95%={0.165344, 0.533547}]: 0.416568, (Puru: 0.290695, (Lpar: 0.139867, Lbir: 0.139867) [&95%={0.0694217, 0.246189}]: 0.150828) [&95%={0.173118, 0.460828}]: 0.442283) [&95%={0.509826, 1.00743}]: 0.334404) [&95%={0.81721, 1.37173}]: 0.270612) [&95%={1.0372, 1.72407}]: 1.172424, ((Chis: 0.473360, C146: 0.473360) [&95%={0.228721, 0.87455}]: 1.578323, (Scry: 1.746429, ((Pped: 1.145554, (Pleu: 0.620128, Enor: 0.620128) [&95%={0.347155, 0.927119}]: 0.525426) [&95%={0.852557, 1.3821}]: 0.418973, ((Bosp: 1.033113, (Elam: 0.174969, Aema: 0.174969) [&95%={0.0836486, 0.319765}]: 0.858144) [&95%={0.726363, 1.26437}]: 0.347246, (Mosp: 1.067007, (Masp: 0.931409, ((Cqua: 0.593561, (Svet: 0.214977, Smuc: 0.214977) [&95%={0.117551, 0.347963}]: 0.378584) [&95%={0.432295, 0.771555}]: 0.123161, (Dmag: 0.477689, (Dgal: 0.248078, (Dpul: 0.035455, Dpli: 0.035455) [&95%={0.0169507, 0.0661883}]: 0.212622) [&95%={0.139681, 0.395482}]: 0.229612) [&95%={0.324664, 0.65741}]: 0.239032) [&95%={0.557674, 0.893607}]: 0.214687) [&95%={0.7504, 1.11807}]: 0.135598) [&95%={0.880946, 1.25109}]: 0.313353) [&95%={1.20392, 1.53248}]: 0.184168) [&95%={1.41422, 1.66666}]: 0.181901) [&95%={1.73162, 1.77336}]: 0.305254) [&95%={1.86519, 2.34935}]: 0.458734) [&95%={2.16988, 2.92673}]: 0.480340) [&95%={2.5598, 3.42445}]: 0.427339) [&95%={2.95818, 3.78503}]: 0.648326) [&95%={4.0506, 4.09603}]: 0.828735) [&95%={4.73156, 5.24009}];"
  )

# disconcordant genes
discGenes_tree <- generate_MCMCtree_object(
  "((Scur: 4.521248, Iele: 4.521248) [&95%={3.48921, 5.12532}]: 0.395764, (((Blyn: 0.187805, Blin: 0.187805) [&95%={0.0870338, 0.359114}]: 1.087259, (Afr1: 1.059711, (Bher: 0.745400, (Stsp: 0.601138, Tpla: 0.601138) [&95%={0.384456, 0.816305}]: 0.144262) [&95%={0.524916, 0.94753}]: 0.314311) [&95%={0.881502, 1.18529}]: 0.215354) [&95%={1.25783, 1.30573}]: 2.790951, (((Tlon: 0.470034, (Tces: 0.042200, (Tcit: 0.005356, Tcjp: 0.005356) [&95%={0.0024313, 0.0104986}]: 0.036844) [&95%={0.0207614, 0.080528}]: 0.427834) [&95%={0.229624, 0.819061}]: 0.761906, ((Lcry: 0.074396, Lpac: 0.074396) [&95%={0.034341, 0.142378}]: 0.175924, (Lubb: 0.086842, (Lapu: 0.072578, (Lcou: 0.035187, Lart: 0.035187) [&95%={0.0179829, 0.0615036}]: 0.037391) [&95%={0.0436774, 0.114589}]: 0.014265) [&95%={0.0548622, 0.132681}]: 0.163478) [&95%={0.150775, 0.415316}]: 0.981620) [&95%={1.21846, 1.25881}]: 2.211494, (Lysp: 2.961206, (((Orub: 0.384732, (Ozsp: 0.316927, Cpil: 0.316927) [&95%={0.161235, 0.551867}]: 0.067804) [&95%={0.217512, 0.636723}]: 1.006594, ((Eosp: 0.958137, (Ldah: 0.503529, Etic: 0.503529) [&95%={0.270183, 0.808566}]: 0.454607) [&95%={0.679962, 1.26388}]: 0.200909, ((Mesp: 0.408836, Etex: 0.408836) [&95%={0.207957, 0.680164}]: 0.422988, (Puru: 0.389910, (Lpar: 0.207035, Lbir: 0.207035) [&95%={0.103358, 0.365358}]: 0.182875) [&95%={0.233037, 0.611905}]: 0.441914) [&95%={0.584932, 1.14113}]: 0.327221) [&95%={0.891339, 1.50434}]: 0.232280) [&95%={1.0753, 1.76963}]: 1.154832, ((Chis: 0.534099, C146: 0.534099) [&95%={0.244046, 0.989418}]: 1.514501, (Scry: 1.746541, ((Pped: 1.164161, (Pleu: 0.668145, Enor: 0.668145) [&95%={0.376343, 0.996087}]: 0.496017) [&95%={0.861203, 1.4237}]: 0.432755, ((Bosp: 1.001790, (Elam: 0.139024, Aema: 0.139024) [&95%={0.0641068, 0.261917}]: 0.862766) [&95%={0.656142, 1.26346}]: 0.424925, (Mosp: 1.095739, (Masp: 0.968235, ((Cqua: 0.616826, (Svet: 0.227996, Smuc: 0.227996) [&95%={0.119161, 0.379202}]: 0.388831) [&95%={0.437885, 0.809867}]: 0.156089, (Dmag: 0.493178, (Dgal: 0.275446, (Dpul: 0.040420, Dpli: 0.040420) [&95%={0.0184146, 0.0780544}]: 0.235026) [&95%={0.152924, 0.438643}]: 0.217732) [&95%={0.329218, 0.682699}]: 0.279737) [&95%={0.600945, 0.960314}]: 0.195320) [&95%={0.778568, 1.14977}]: 0.127504) [&95%={0.89837, 1.2643}]: 0.330976) [&95%={1.23292, 1.56471}]: 0.170201) [&95%={1.45894, 1.6866}]: 0.149625) [&95%={1.73162, 1.77287}]: 0.302059) [&95%={1.85381, 2.38955}]: 0.497557) [&95%={2.16431, 3.01898}]: 0.415049) [&95%={2.49114, 3.4417}]: 0.482229) [&95%={2.92809, 3.8367}]: 0.622580) [&95%={4.05059, 4.09471}]: 0.850997) [&95%={4.73438, 5.26154}];"
  )

# no Lynceus
noLysp_tree <- generate_MCMCtree_object(
  "((Scur: 4.863927, Iele: 4.863927) [&95%={3.88285, 5.70173}]: 0.313904, (((Blyn: 0.185796, Blin: 0.185796) [&95%={0.0859153, 0.359523}]: 1.089322, (Afr1: 1.052181, (Bher: 0.740522, (Stsp: 0.596549, Tpla: 0.596549) [&95%={0.381851, 0.811702}]: 0.143973) [&95%={0.525174, 0.945344}]: 0.311659) [&95%={0.871331, 1.18206}]: 0.222937) [&95%={1.25783, 1.30522}]: 2.790947, (((Tlon: 0.462743, (Tces: 0.042857, (Tcit: 0.005018, Tcjp: 0.005018) [&95%={0.0022232, 0.010016}]: 0.037839) [&95%={0.0207187, 0.0815595}]: 0.419886) [&95%={0.226565, 0.814679}]: 0.769169, ((Lcry: 0.074765, Lpac: 0.074765) [&95%={0.0342813, 0.142224}]: 0.165278, (Lubb: 0.087057, (Lapu: 0.072738, (Lcou: 0.035859, Lart: 0.035859) [&95%={0.0177628, 0.0632671}]: 0.036879) [&95%={0.0431455, 0.115726}]: 0.014319) [&95%={0.0542813, 0.13529}]: 0.152985) [&95%={0.143118, 0.400942}]: 0.991870) [&95%={1.21847, 1.25873}]: 2.156051, (((Orub: 0.374726, (Ozsp: 0.302196, Cpil: 0.302196) [&95%={0.153425, 0.527601}]: 0.072530) [&95%={0.21168, 0.61624}]: 1.026867, ((Eosp: 0.956916, (Ldah: 0.499109, Etic: 0.499109) [&95%={0.264269, 0.803469}]: 0.457807) [&95%={0.674988, 1.26388}]: 0.203197, ((Mesp: 0.401734, Etex: 0.401734) [&95%={0.208998, 0.669816}]: 0.425390, (Puru: 0.378251, (Lpar: 0.197017, Lbir: 0.197017) [&95%={0.0978702, 0.348621}]: 0.181234) [&95%={0.223907, 0.596541}]: 0.448873) [&95%={0.572868, 1.12573}]: 0.332990) [&95%={0.885692, 1.49981}]: 0.241480) [&95%={1.07961, 1.76398}]: 1.185227, ((Chis: 0.532700, C146: 0.532700) [&95%={0.240379, 0.98622}]: 1.524170, (Scry: 1.746539, ((Pped: 1.155797, (Pleu: 0.655812, Enor: 0.655812) [&95%={0.361964, 0.984675}]: 0.499985) [&95%={0.844007, 1.41379}]: 0.435354, ((Bosp: 1.007536, (Elam: 0.146766, Aema: 0.146766) [&95%={0.0678127, 0.277698}]: 0.860771) [&95%={0.67428, 1.26327}]: 0.412950, (Mosp: 1.094001, (Masp: 0.964201, ((Cqua: 0.615330, (Svet: 0.227503, Smuc: 0.227503) [&95%={0.120217, 0.37481}]: 0.387826) [&95%={0.436267, 0.809836}]: 0.152218, (Dmag: 0.492481, (Dgal: 0.272142, (Dpul: 0.039921, Dpli: 0.039921) [&95%={0.0182227, 0.0764653}]: 0.232221) [&95%={0.152323, 0.434471}]: 0.220338) [&95%={0.326218, 0.686956}]: 0.275067) [&95%={0.591468, 0.955047}]: 0.196654) [&95%={0.772493, 1.15132}]: 0.129800) [&95%={0.892096, 1.26519}]: 0.326485) [&95%={1.22873, 1.55914}]: 0.170665) [&95%={1.44637, 1.68347}]: 0.155387) [&95%={1.73168, 1.77323}]: 0.310331) [&95%={1.854, 2.41957}]: 0.529950) [&95%={2.18109, 3.12629}]: 0.801143) [&95%={2.81035, 3.82134}]: 0.678101) [&95%={4.05059, 4.09493}]: 1.111767) [&95%={4.89022, 5.88492}];"
  )

# uniform distribution
uniform_tree <- generate_MCMCtree_object(
  "((Scur: 4.219773, Iele: 4.219773) [&95%={3.11134, 5.02879}]: 0.847928, (((Blyn: 0.241970, Blin: 0.241970) [&95%={0.117836, 0.444496}]: 1.950249, (Afr1: 1.777969, (Bher: 1.174521, (Stsp: 0.969138, Tpla: 0.969138) [&95%={0.58477, 1.47382}]: 0.205383) [&95%={0.771598, 1.70877}]: 0.603448) [&95%={1.22482, 2.53927}]: 0.414251) [&95%={1.5764, 3.09379}]: 2.566664, (((Tlon: 0.546729, (Tita: 0.053884, (Tusa: 0.006246, Tjap: 0.006246) [&95%={0.0030127, 0.0115787}]: 0.047638) [&95%={0.0277487, 0.0962538}]: 0.492844) [&95%={0.290987, 0.912701}]: 0.797062, ((Lcry: 0.095241, Lpac: 0.095241) [&95%={0.0473564, 0.171604}]: 0.204119, (Lubb: 0.110925, (Lapu: 0.093216, (Lcou: 0.046321, Lart: 0.046321) [&95%={0.0249656, 0.0783802}]: 0.046896) [&95%={0.0579907, 0.143762}]: 0.017708) [&95%={0.0715813, 0.166401}]: 0.188435) [&95%={0.189242, 0.471811}]: 1.044431) [&95%={0.987341, 1.86372}]: 2.912188, (Lysp: 3.842969, (((Orub: 0.480215, (Ozsp: 0.391354, Cpil: 0.391354) [&95%={0.210897, 0.669802}]: 0.088861) [&95%={0.283668, 0.774374}]: 1.404082, ((Eosp: 1.277132, (Ldah: 0.658104, Etic: 0.658104) [&95%={0.362023, 1.05203}]: 0.619029) [&95%={0.884514, 1.79198}]: 0.269814, ((Mesp: 0.520730, Etex: 0.520730) [&95%={0.27876, 0.840053}]: 0.560543, (Puru: 0.484829, (Lpar: 0.252961, Lbir: 0.252961) [&95%={0.133407, 0.426697}]: 0.231869) [&95%={0.294901, 0.743298}]: 0.596444) [&95%={0.747637, 1.51445}]: 0.465673) [&95%={1.12893, 2.08991}]: 0.337351) [&95%={1.37722, 2.52529}]: 1.570895, ((Chis: 0.675839, C146: 0.675839) [&95%={0.338428, 1.19503}]: 2.336969, (Scry: 2.716030, ((Pped: 1.751478, (Pleu: 0.950784, Enor: 0.950784) [&95%={0.529732, 1.47453}]: 0.800694) [&95%={1.17721, 2.34243}]: 0.692859, ((Bosp: 1.498694, (Elam: 0.189694, Aema: 0.189694) [&95%={0.0948003, 0.345019}]: 1.309000) [&95%={0.977229, 2.06476}]: 0.660248, (Mosp: 1.569398, (Masp: 1.376977, ((Cqua: 0.862791, (Svet: 0.303675, Smuc: 0.303675) [&95%={0.167035, 0.493496}]: 0.559116) [&95%={0.607963, 1.16602}]: 0.210273, (Dmag: 0.676572, (Dgal: 0.368854, (Dpul: 0.050771, Dpli: 0.050771) [&95%={0.0247111, 0.093887}]: 0.318082) [&95%={0.208879, 0.586036}]: 0.307718) [&95%={0.442114, 0.958767}]: 0.396492) [&95%={0.803575, 1.39434}]: 0.303913) [&95%={1.04159, 1.76235}]: 0.192421) [&95%={1.19677, 1.989}]: 0.589544) [&95%={1.70202, 2.65638}]: 0.285395) [&95%={1.95883, 2.97862}]: 0.271693) [&95%={2.19476, 3.28248}]: 0.296778) [&95%={2.47306, 3.5837}]: 0.442385) [&95%={2.89719, 4.02122}]: 0.387777) [&95%={3.26456, 4.39515}]: 0.413010) [&95%={3.68053, 4.77305}]: 0.502905) [&95%={4.22395, 5.18676}]: 0.308817) [&95%={4.75982, 5.30522}];"
)


## LOAD AGE DATAFRAMES
# tidy up dataframes
allTree_ages <- tidy_age_df(all_tree$nodeAges, "allTree")

noBran_ages <- tidy_age_df(noBran_tree$nodeAges, "noBran")
noAnos_ages <- tidy_age_df(noAnos_tree$nodeAges, "noAnos")
noNoto_ages <- tidy_age_df(noNoto_tree$nodeAges, "noNoto")
noClad_ages <- tidy_age_df(noClad_tree$nodeAges, "noClad")

noCladBra_ages <- tidy_age_df(noCladBra_tree$nodeAges, "noCladBra")
noCladAnos_ages <- tidy_age_df(noCladAnos_tree$nodeAges, "noCladAnos")
noCladNoto_ages <- tidy_age_df(noCladNoto_tree$nodeAges, "noCladNoto")
uniform_ages <- tidy_age_df(uniform_tree$nodeAges, "uniform")

concGenes_ages <- tidy_age_df(concGenes_tree$nodeAges, "concGenes")
discGenes_ages <- tidy_age_df(discGenes_tree$nodeAges, "discGenes")
noLysp_ages <- tidy_age_df(noLysp_tree$nodeAges, "noLysp") %>%
  # adjust node labels to the absenc of Lysp
  mutate(Node = ifelse(Node <= 65, Node+1, Node+2))

## PLOTS SINGLE JACK-KNIFE RESULTS
# merge age dataframes
df_list_1jackknife <- list(allTree_ages,
                           noBran_ages,
                           noAnos_ages,
                           noNoto_ages,
                           noClad_ages)

# define order of panels
order_plots_1jackknife <- c("noBran", "noAnos", "noNoto", "noClad")

# define strip labels
labeller_1jackknife <- c('noBran' = "A) No Branchiopoda",
                         'noAnos' = "B) No Anostraca",
                         'noNoto' = "C) No Notostraca",
                         'noClad' = "D) No Cladocera")

# generate plot
plot_corr_1jackknife <- plot_corr(df_list_1jackknife, order_plots_1jackknife, labeller_1jackknife, 2)
plot_corr_1jackknife


## PLOTS DOUBLE JACK-KNIFE RESULTS
# merge age dataframes
df_list_2jackknife <- list(allTree_ages,
                           noCladBra_ages,
                           noCladAnos_ages,
                           noCladNoto_ages,
                           uniform_ages)

# define order of panels
order_plots_2jackknife <- c("noCladBra", "noCladAnos", "noCladNoto", "uniform")

# define strip labels
labeller_2jackknife <- c('noCladBra' = "A) No Branchiopoda no Cladocea",
                         'noCladAnos' = "B) No Anostraca no Cladocera",
                         'noCladNoto' = "C) No Notostraca no Cladocea",
                         'uniform' = "D) Uniform distributions of priors")

# generate plot
plot_corr_2jackknife <- plot_corr(df_list_2jackknife, order_plots_2jackknife, labeller_2jackknife, 2)
plot_corr_2jackknife

# BIG PLOT
df_list_big <- c(df_list_1jackknife, df_list_2jackknife[-1])

order_plots_big <- c(order_plots_1jackknife, order_plots_2jackknife)

labeller_big <- c('noBran' = "A) No Branchiopoda",
                  'noAnos' = "B) No Anostraca",
                  'noNoto' = "C) No Notostraca",
                  'noClad' = "D) No Cladocera",
                  'noCladBra' = "E) No Branchiopoda no Cladocea",
                  'noCladAnos' = "F) No Anostraca no Cladocera",
                  'noCladNoto' = "G) No Notostraca no Cladocea",
                  'uniform' = "H) Uniform distributions of priors")

plot_big <- plot_corr(df_list_big, order_plots_big, labeller_big, 2)
plot_big

## PLOTS SUBSETS RESULTS
# merge age dataframes
df_list_subsets <- list(allTree_ages,
                        concGenes_ages,
                        discGenes_ages,
                        noLysp_ages)

# define order of panels
order_plots_subsets <- c("noLysp", "concGenes", "discGenes")

# define strip labels
labeller_subsets <- c('noLysp' = "A) No Lynceus sp.",
                      'concGenes' = "B) Concordant genes",
                      'discGenes' = "C) Discordant genes")

# generate plot
plot_corr_subsets <- plot_corr(df_list_subsets, order_plots_subsets, labeller_subsets, 1)
plot_corr_subsets


########################
#     SAVE RESULTS     #
########################

ggsave("figure_3.png",
       plot = plot_corr_1jackknife, device = "png",
       dpi = 300, height = 8, width = 8, units = ("in"), bg = 'white')

ggsave("supp_figure_S3.png",
       plot = plot_corr_2jackknife, device = "png",
       dpi = 300, height = 4, width = 12, units = ("in"), bg = 'white')

ggsave("supp_figure_S4.png",
       plot = plot_corr_subsets, device = "png",
       dpi = 300, height = 4, width = 12, units = ("in"), bg = 'white')

ggsave("plot_big.png",
       plot = plot_big, device = "png",
       dpi = 300, height = 8, width = 12, units = ("in"), bg = 'white')


