# BRANCHIO PLOTTING
# Needed packages
library(MCMCtreeR, quietly = TRUE, warn.conflicts = FALSE)
library(readr)
library(ape)
library(scales)
library(ggplot2)
library(tm)
library(gridExtra)
library(fmsb)
library(devtools)
library(ggradar)
library(cowplot)
library(dplyr)
cat("All required packages have been successfully loaded.\n")

#FIGURA 1
branchiopoda_occ<-read.table("./branchiopoda_occ.txt", sep=",", header = T)
branchiopoda_occ<-cbind(rep("Branchiopoda",length(branchiopoda_occ[1])),branchiopoda_occ)
colnames(branchiopoda_occ)[1]<-"Group"

cladocera_occ<-read.table("./cladocera_occ.txt", sep=",", header = T)
cladocera_occ<-cbind(rep("Cladocera",length(cladocera_occ[1])),cladocera_occ)
colnames(cladocera_occ)[1]<-"Group"

notostraca_occ<-read.table("./notostraca_occ.txt", sep=",", header = T)
notostraca_occ<-cbind(rep("Notostraca",length(notostraca_occ[1])),notostraca_occ)
colnames(notostraca_occ)[1]<-"Group"

anostraca_occ<-read.table("./anostraca_occ.txt", sep=",", header = T)
anostraca_occ<-cbind(rep("Anostraca",length(anostraca_occ[1])),anostraca_occ)
colnames(anostraca_occ)[1]<-"Group"



fossils<-rbind(branchiopoda_occ,cladocera_occ,notostraca_occ,anostraca_occ)


my_colors <- c("#008080", "#B87333","#FF6347","#DAA520")


plot_multi <- ggplot(fossils, aes(x = max_ma, fill = Group)) +
  geom_histogram(adjust = 1.5, position = "identity", bins = 50) +
  theme_bw() +
  scale_fill_manual(values = my_colors) +
  scale_x_reverse() +
  xlim(520, 0) +
  facet_wrap(~Group, scales = "free_y", ncol = 1) +  # Use 'facet_wrap' for grouping
  theme(strip.background = element_blank(),  # Remove background color for facet titles
        legend.position = "none")  # Remove the legend


pdf("./fossils_occurences.pdf", width = 11.7, height = 8.3)
plot_multi
dev.off()













# JACKKNIFE PLOT
# All fossils
all.tree <- as.character(c("#NEXUS","begin trees",""," ((Scur: 3.634059, Iele: 3.634059) [&95%={0.737279, 5.08848}]: 1.324361, (((Blyn: 0.266181, Blin: 0.266181) [&95%={0.0658616, 0.597975}]: 1.007608, (Afr1: 1.036729, (Bher: 0.707185, (Stsp: 0.609131, Tpla: 0.609131) [&95%={0.330011, 0.880737}]: 0.098054) [&95%={0.401843, 0.965316}]: 0.329544) [&95%={0.777679, 1.17695}]: 0.237060) [&95%={1.25782, 1.30339}]: 2.792129, (((Tlon: 0.855106, (Tita: 0.294715, (Tusa: 0.060144, Tjap: 0.060144) [&95%={0.020136, 0.137451}]: 0.234571) [&95%={0.134932, 0.50772}]: 0.560391) [&95%={0.62279, 1.03039}]: 0.380029, ((Lcry: 0.315365, Lpac: 0.315365) [&95%={0.148522, 0.536336}]: 0.400666, (Lubb: 0.370249, (Lapu: 0.310294, (Lcou: 0.137258, Lart: 0.137258) [&95%={0.0653136, 0.255869}]: 0.173035) [&95%={0.175744, 0.490623}]: 0.059955) [&95%={0.218267, 0.559086}]: 0.345782) [&95%={0.516854, 0.904909}]: 0.519104) [&95%={1.21872, 1.26526}]: 1.987149, (Lysp: 2.740275, (((Orub: 0.570989, (Ozsp: 0.481092, Cpil: 0.481092) [&95%={0.196043, 0.91723}]: 0.089897) [&95%={0.240827, 1.03756}]: 0.812647, ((Eosp: 0.983066, (Ldah: 0.508189, Etic: 0.508189) [&95%={0.209599, 0.900334}]: 0.474877) [&95%={0.597835, 1.38715}]: 0.170545, ((Mesp: 0.415036, Etex: 0.415036) [&95%={0.165884, 0.774029}]: 0.412751, (Puru: 0.393182, (Lpar: 0.205961, Lbir: 0.205961) [&95%={0.0720999, 0.442125}]: 0.187221) [&95%={0.155502, 0.738493}]: 0.434606) [&95%={0.451611, 1.2405}]: 0.325824) [&95%={0.733726, 1.56866}]: 0.230024) [&95%={0.920754, 1.8293}]: 0.972400, ((Chis: 0.736458, C146: 0.736458) [&95%={0.186309, 1.28747}]: 1.220668, (Scry: 1.745134, ((Pped: 1.241071, (Pleu: 0.724312, Enor: 0.724312) [&95%={0.296855, 1.17707}]: 0.516759) [&95%={0.829608, 1.51031}]: 0.346428, ((Bosp: 1.177837, (Elam: 0.257397, Aema: 0.257397) [&95%={0.0847145, 0.564084}]: 0.920440) [&95%={0.874826, 1.40847}]: 0.254409, (Mosp: 1.051237, (Masp: 0.979396, ((Cqua: 0.725484, (Svet: 0.313429, Smuc: 0.313429) [&95%={0.180215, 0.500434}]: 0.412055) [&95%={0.514604, 0.951929}]: 0.090934, (Dmag: 0.569249, (Dgal: 0.350995, (Dpul: 0.059634, Dpli: 0.059634) [&95%={0.0214312, 0.138137}]: 0.291361) [&95%={0.176489, 0.575961}]: 0.218254) [&95%={0.349793, 0.805346}]: 0.247170) [&95%={0.595635, 1.04098}]: 0.162978) [&95%={0.739202, 1.19704}]: 0.071841) [&95%={0.807219, 1.25929}]: 0.381009) [&95%={1.22321, 1.5701}]: 0.155253) [&95%={1.42735, 1.67234}]: 0.157635) [&95%={1.73152, 1.77082}]: 0.211992) [&95%={1.83139, 2.22748}]: 0.398909) [&95%={2.02756, 2.89972}]: 0.384239) [&95%={2.23434, 3.37384}]: 0.482009) [&95%={2.52256, 3.76637}]: 0.843633) [&95%={4.0506, 4.09484}]: 0.892502) [&95%={4.73972, 5.28311}];","END;"))
all.tree <- readMCMCtree(all.tree, from.file = FALSE)
# No 1
no1.tree <- as.character(c("#NEXUS","begin trees",""," ((Scur: 4.545354, Iele: 4.545354) [&95%={3.6096, 5.13489}]: 0.372651, (((Blyn: 0.194618, Blin: 0.194618) [&95%={0.0898514, 0.372521}]: 1.492757, (Afr1: 1.351545, (Bher: 0.914552, (Stsp: 0.750826, Tpla: 0.750826) [&95%={0.439405, 1.11716}]: 0.163726) [&95%={0.58642, 1.28542}]: 0.436994) [&95%={0.943223, 1.90493}]: 0.335829) [&95%={1.18207, 2.39346}]: 2.378752, (((Tlon: 0.465025, (Tita: 0.043575, (Tusa: 0.004998, Tjap: 0.004998) [&95%={0.0023062, 0.0096358}]: 0.038578) [&95%={0.0212877, 0.0820564}]: 0.421449) [&95%={0.2333, 0.794419}]: 0.767781, ((Lcry: 0.076492, Lpac: 0.076492) [&95%={0.0363927, 0.141044}]: 0.167774, (Lubb: 0.088828, (Lapu: 0.074369, (Lcou: 0.036806, Lart: 0.036806) [&95%={0.0190316, 0.0646901}]: 0.037562) [&95%={0.0456319, 0.117127}]: 0.014459) [&95%={0.0567158, 0.136143}]: 0.155438) [&95%={0.150102, 0.39687}]: 0.988540) [&95%={1.21854, 1.26035}]: 2.225822, (Lysp: 2.991085, (((Orub: 0.378959, (Ozsp: 0.306729, Cpil: 0.306729) [&95%={0.160464, 0.538998}]: 0.072230) [&95%={0.218714, 0.624789}]: 1.066460, ((Eosp: 0.982998, (Ldah: 0.509993, Etic: 0.509993) [&95%={0.274723, 0.815146}]: 0.473005) [&95%={0.697957, 1.30364}]: 0.206230, ((Mesp: 0.409412, Etex: 0.409412) [&95%={0.213942, 0.676962}]: 0.433383, (Puru: 0.384329, (Lpar: 0.199439, Lbir: 0.199439) [&95%={0.0996961, 0.348838}]: 0.184891) [&95%={0.228753, 0.597811}]: 0.458465) [&95%={0.585533, 1.14716}]: 0.346434) [&95%={0.902681, 1.52722}]: 0.256192) [&95%={1.09567, 1.81392}]: 1.117352, ((Chis: 0.535220, C146: 0.535220) [&95%={0.260464, 0.96797}]: 1.526318, (Scry: 1.746902, ((Pped: 1.164216, (Pleu: 0.659873, Enor: 0.659873) [&95%={0.378384, 0.982494}]: 0.504343) [&95%={0.865267, 1.43007}]: 0.435568, ((Bosp: 1.007926, (Elam: 0.148782, Aema: 0.148782) [&95%={0.0708153, 0.276806}]: 0.859145) [&95%={0.692827, 1.25522}]: 0.424801, (Mosp: 1.101071, (Masp: 0.972717, ((Cqua: 0.620126, (Svet: 0.228672, Smuc: 0.228672) [&95%={0.122662, 0.374781}]: 0.391454) [&95%={0.450142, 0.801824}]: 0.153814, (Dmag: 0.500213, (Dgal: 0.276836, (Dpul: 0.040149, Dpli: 0.040149) [&95%={0.0188913, 0.0765584}]: 0.236687) [&95%={0.156966, 0.437803}]: 0.223377) [&95%={0.341519, 0.68208}]: 0.273727) [&95%={0.611441, 0.948546}]: 0.198778) [&95%={0.797454, 1.13953}]: 0.128354) [&95%={0.921993, 1.26045}]: 0.331657) [&95%={1.27098, 1.55679}]: 0.167055) [&95%={1.4781, 1.68311}]: 0.147119) [&95%={1.73176, 1.77368}]: 0.314635) [&95%={1.86314, 2.38433}]: 0.501234) [&95%={2.19371, 3.00019}]: 0.428314) [&95%={2.53724, 3.44358}]: 0.467542) [&95%={2.97065, 3.82814}]: 0.607499) [&95%={4.05066, 4.09462}]: 0.851879) [&95%={4.73433, 5.26277}];","END;"))
no1.tree <- readMCMCtree(no1.tree, from.file = FALSE)
# No 2
no2.tree <- as.character(c("#NEXUS","begin trees",""," ((Scur: 4.570994, Iele: 4.570994) [&95%={3.67522, 5.1203}]: 0.340136, (((Blyn: 0.177251, Blin: 0.177251) [&95%={0.0848246, 0.332784}]: 1.095989, (Afr1: 1.052981, (Bher: 0.739806, (Stsp: 0.600491, Tpla: 0.600491) [&95%={0.385832, 0.813561}]: 0.139315) [&95%={0.525074, 0.939341}]: 0.313175) [&95%={0.878538, 1.17836}]: 0.220259) [&95%={1.2577, 1.30224}]: 2.792782, (((Tlon: 0.394747, (Tita: 0.040514, (Tusa: 0.004683, Tjap: 0.004683) [&95%={0.002151, 0.0090333}]: 0.035831) [&95%={0.0201569, 0.0751814}]: 0.354233) [&95%={0.203047, 0.694853}]: 0.548135, ((Lcry: 0.071436, Lpac: 0.071436) [&95%={0.0336235, 0.133729}]: 0.153561, (Lubb: 0.083386, (Lapu: 0.069844, (Lcou: 0.034644, Lart: 0.034644) [&95%={0.0180212, 0.0593996}]: 0.035200) [&95%={0.0428383, 0.109183}]: 0.013541) [&95%={0.0536606, 0.126249}]: 0.141611) [&95%={0.138241, 0.360742}]: 0.717885) [&95%={0.585592, 1.41713}]: 2.481910, (Lysp: 2.953956, (((Orub: 0.357272, (Ozsp: 0.289444, Cpil: 0.289444) [&95%={0.150453, 0.499148}]: 0.067828) [&95%={0.205892, 0.578724}]: 1.004060, ((Eosp: 0.929668, (Ldah: 0.482261, Etic: 0.482261) [&95%={0.258261, 0.762821}]: 0.447407) [&95%={0.661146, 1.22285}]: 0.194912, ((Mesp: 0.388525, Etex: 0.388525) [&95%={0.204861, 0.638226}]: 0.411467, (Puru: 0.360926, (Lpar: 0.188335, Lbir: 0.188335) [&95%={0.0964201, 0.325335}]: 0.172590) [&95%={0.215721, 0.557346}]: 0.439066) [&95%={0.5704, 1.07517}]: 0.324589) [&95%={0.870957, 1.44129}]: 0.236751) [&95%={1.06323, 1.7281}]: 1.167594, ((Chis: 0.514019, C146: 0.514019) [&95%={0.241797, 0.946216}]: 1.531450, (Scry: 1.746386, ((Pped: 1.151533, (Pleu: 0.651518, Enor: 0.651518) [&95%={0.370884, 0.970535}]: 0.500015) [&95%={0.8519, 1.40887}]: 0.438107, ((Bosp: 0.997194, (Elam: 0.140946, Aema: 0.140946) [&95%={0.0667217, 0.262862}]: 0.856248) [&95%={0.675189, 1.25187}]: 0.417876, (Mosp: 1.080287, (Masp: 0.952826, ((Cqua: 0.604058, (Svet: 0.218673, Smuc: 0.218673) [&95%={0.117488, 0.357406}]: 0.385385) [&95%={0.435467, 0.787257}]: 0.149638, (Dmag: 0.483128, (Dgal: 0.266442, (Dpul: 0.037902, Dpli: 0.037902) [&95%={0.0177248, 0.0724453}]: 0.228540) [&95%={0.148407, 0.426607}]: 0.216686) [&95%={0.325529, 0.666051}]: 0.270567) [&95%={0.588822, 0.929023}]: 0.199130) [&95%={0.766798, 1.12867}]: 0.127461) [&95%={0.889258, 1.2507}]: 0.334784) [&95%={1.22338, 1.55365}]: 0.174569) [&95%={1.44917, 1.68181}]: 0.156747) [&95%={1.73165, 1.77237}]: 0.299083) [&95%={1.85589, 2.36271}]: 0.483456) [&95%={2.16252, 2.99115}]: 0.425030) [&95%={2.49403, 3.43034}]: 0.470836) [&95%={2.91414, 3.82383}]: 0.641230) [&95%={4.05062, 4.09543}]: 0.845108) [&95%={4.73308, 5.25563}];","END;"))
no2.tree <- readMCMCtree(no2.tree, from.file = FALSE)
# No 3
no3.tree <- as.character(c("#NEXUS","begin trees",""," ((Scur: 4.502765, Iele: 4.502765) [&95%={3.52328, 5.11892}]: 0.412609, (((Blyn: 0.194956, Blin: 0.194956) [&95%={0.0937995, 0.363964}]: 1.080599, (Afr1: 1.057199, (Bher: 0.748820, (Stsp: 0.604689, Tpla: 0.604689) [&95%={0.39962, 0.808969}]: 0.144130) [&95%={0.546897, 0.940106}]: 0.308380) [&95%={0.889992, 1.17812}]: 0.218356) [&95%={1.25786, 1.306}]: 2.790866, (((Tlon: 0.479348, (Tita: 0.044668, (Tusa: 0.005140, Tjap: 0.005140) [&95%={0.0023986, 0.0097184}]: 0.039528) [&95%={0.022568, 0.0822742}]: 0.434680) [&95%={0.244492, 0.8045}]: 0.753446, ((Lcry: 0.078489, Lpac: 0.078489) [&95%={0.0379632, 0.14356}]: 0.171345, (Lubb: 0.091565, (Lapu: 0.076781, (Lcou: 0.037782, Lart: 0.037782) [&95%={0.0197754, 0.0647102}]: 0.038998) [&95%={0.0476106, 0.119883}]: 0.014784) [&95%={0.0592488, 0.13845}]: 0.158270) [&95%={0.154508, 0.404308}]: 0.982959) [&95%={1.21854, 1.26032}]: 2.372027, (Lysp: 3.230432, (((Orub: 0.394220, (Ozsp: 0.320454, Cpil: 0.320454) [&95%={0.169328, 0.54625}]: 0.073766) [&95%={0.230459, 0.633016}]: 1.067787, ((Eosp: 0.984028, (Ldah: 0.516424, Etic: 0.516424) [&95%={0.286715, 0.818247}]: 0.467604) [&95%={0.708938, 1.27787}]: 0.208338, ((Mesp: 0.415893, Etex: 0.415893) [&95%={0.222677, 0.682898}]: 0.436287, (Puru: 0.392537, (Lpar: 0.205892, Lbir: 0.205892) [&95%={0.106499, 0.354488}]: 0.186645) [&95%={0.239848, 0.60448}]: 0.459643) [&95%={0.607449, 1.18088}]: 0.340186) [&95%={0.922585, 1.59744}]: 0.269640) [&95%={1.13249, 2.00192}]: 1.419120, ((Chis: 0.569570, C146: 0.569570) [&95%={0.272991, 1.04119}]: 1.917395, (Scry: 2.228284, ((Pped: 1.358136, (Pleu: 0.753348, Enor: 0.753348) [&95%={0.409538, 1.21052}]: 0.604788) [&95%={0.955545, 1.89846}]: 0.638657, ((Bosp: 1.168675, (Elam: 0.156096, Aema: 0.156096) [&95%={0.0749631, 0.289244}]: 1.012579) [&95%={0.798729, 1.60191}]: 0.581245, (Mosp: 1.242071, (Masp: 1.092742, ((Cqua: 0.691931, (Svet: 0.246521, Smuc: 0.246521) [&95%={0.133663, 0.406401}]: 0.445409) [&95%={0.495793, 0.906451}]: 0.169852, (Dmag: 0.546401, (Dgal: 0.298489, (Dpul: 0.041562, Dpli: 0.041562) [&95%={0.0198297, 0.077226}]: 0.256927) [&95%={0.168625, 0.475645}]: 0.247912) [&95%={0.366493, 0.758908}]: 0.315382) [&95%={0.666993, 1.07482}]: 0.230960) [&95%={0.883318, 1.31663}]: 0.149328) [&95%={1.02547, 1.52733}]: 0.507849) [&95%={1.44719, 2.11651}]: 0.246874) [&95%={1.66476, 2.39251}]: 0.231491) [&95%={1.87062, 2.62823}]: 0.258681) [&95%={2.09906, 2.89651}]: 0.394162) [&95%={2.46756, 3.27015}]: 0.349305) [&95%={2.81352, 3.58796}]: 0.374389) [&95%={3.2183, 3.8741}]: 0.461601) [&95%={4.05069, 4.09543}]: 0.848953) [&95%={4.735, 5.26079}];","END;"))
no3.tree <- readMCMCtree(no3.tree, from.file = FALSE)
# No 4
no4.tree <- as.character(c("#NEXUS","begin trees",""," ((Scur: 4.465580, Iele: 4.465580) [&95%={3.33452, 5.10306}]: 0.459878, (((Blyn: 0.184207, Blin: 0.184207) [&95%={0.0834089, 0.354123}]: 1.090862, (Afr1: 1.053789, (Bher: 0.741610, (Stsp: 0.599761, Tpla: 0.599761) [&95%={0.384523, 0.81356}]: 0.141849) [&95%={0.524897, 0.944602}]: 0.312180) [&95%={0.875451, 1.18038}]: 0.221280) [&95%={1.25786, 1.30517}]: 2.932861, (((Tlon: 0.462219, (Tita: 0.042325, (Tusa: 0.004871, Tjap: 0.004871) [&95%={0.0021864, 0.0095988}]: 0.037454) [&95%={0.0206514, 0.0810233}]: 0.419894) [&95%={0.224696, 0.805649}]: 0.769710, ((Lcry: 0.074425, Lpac: 0.074425) [&95%={0.0347255, 0.141863}]: 0.164152, (Lubb: 0.086151, (Lapu: 0.072021, (Lcou: 0.035475, Lart: 0.035475) [&95%={0.0179774, 0.0615391}]: 0.036545) [&95%={0.0436187, 0.113657}]: 0.014130) [&95%={0.0544796, 0.131751}]: 0.152426) [&95%={0.143526, 0.39528}]: 0.993353) [&95%={1.21848, 1.25876}]: 2.279907, (Lysp: 3.018192, (((Orub: 0.369387, (Ozsp: 0.298530, Cpil: 0.298530) [&95%={0.154004, 0.522157}]: 0.070857) [&95%={0.211986, 0.605985}]: 1.014219, ((Eosp: 0.943501, (Ldah: 0.490177, Etic: 0.490177) [&95%={0.261952, 0.796742}]: 0.453324) [&95%={0.666396, 1.26086}]: 0.200614, ((Mesp: 0.395534, Etex: 0.395534) [&95%={0.202067, 0.652988}]: 0.420203, (Puru: 0.372580, (Lpar: 0.194490, Lbir: 0.194490) [&95%={0.0987225, 0.340565}]: 0.178091) [&95%={0.223256, 0.577885}]: 0.443157) [&95%={0.576029, 1.12255}]: 0.328378) [&95%={0.87789, 1.49551}]: 0.239491) [&95%={1.07667, 1.78052}]: 1.185887, ((Chis: 0.524097, C146: 0.524097) [&95%={0.244099, 0.976962}]: 1.532962, (Scry: 1.746567, ((Pped: 1.159734, (Pleu: 0.659195, Enor: 0.659195) [&95%={0.367754, 0.982363}]: 0.500540) [&95%={0.850441, 1.41716}]: 0.431210, ((Bosp: 1.003591, (Elam: 0.144822, Aema: 0.144822) [&95%={0.0667274, 0.273061}]: 0.858770) [&95%={0.671659, 1.2629}]: 0.412226, (Mosp: 1.083666, (Masp: 0.955128, ((Cqua: 0.605810, (Svet: 0.223790, Smuc: 0.223790) [&95%={0.118674, 0.370758}]: 0.382020) [&95%={0.429123, 0.798361}]: 0.151810, (Dmag: 0.485930, (Dgal: 0.268588, (Dpul: 0.038992, Dpli: 0.038992) [&95%={0.0181031, 0.0748627}]: 0.229596) [&95%={0.148645, 0.429312}]: 0.217341) [&95%={0.326037, 0.678764}]: 0.271690) [&95%={0.582713, 0.947522}]: 0.197509) [&95%={0.758533, 1.14669}]: 0.128538) [&95%={0.877547, 1.26341}]: 0.332151) [&95%={1.22052, 1.55877}]: 0.175127) [&95%={1.44307, 1.68303}]: 0.155623) [&95%={1.73167, 1.77312}]: 0.310492) [&95%={1.85444, 2.42067}]: 0.512435) [&95%={2.16114, 3.1775}]: 0.448698) [&95%={2.47819, 3.72727}]: 0.493644) [&95%={2.85575, 4.26597}]: 0.696094) [&95%={3.40507, 4.93533}]: 0.717529) [&95%={4.7356, 5.26189}];","END;"))
no4.tree <- readMCMCtree(no4.tree, from.file = FALSE)


dates <- as.data.frame(cbind(all.tree$nodeAges[,1],no1.tree$nodeAges[,1],no2.tree$nodeAges[,1],no3.tree$nodeAges[,1],no4.tree$nodeAges[,1]))
colnames(dates) <- c("mean_all","mean_no1","mean_no2","mean_no3","mean_no4")
dates <- dates[!(row.names(dates) %in% c("50")),]
library(ggplot2)
plot1 <- ggplot(dates,aes(x=mean_all*100, y=mean_no1*100)) +
  geom_point() +
  ggtitle("All Calibrations vs No Anostraca Calibration") +
  labs(x = "Date estimates with all calibrations", y = "Date estimates without Anostraca calibration") +
  geom_abline(slope = 1, intercept = 0, lty=2, color = "#008080") +
  geom_errorbar(aes(xmin=all.tree$nodeAges[!(row.names(all.tree$nodeAges) %in% c("50")),2]*100, xmax=all.tree$nodeAges[!(row.names(all.tree$nodeAges) %in% c("50")),3]*100), width = 0.05, lty=2,col="salmon") +
  geom_errorbar(aes(ymin=no1.tree$nodeAges[!(row.names(no1.tree$nodeAges) %in% c("50")),2]*100, ymax=no1.tree$nodeAges[!(row.names(no1.tree$nodeAges) %in% c("50")),3]*100), width = 0.05, lty=2,col="salmon")

plot2 <- ggplot(dates,aes(x=mean_all*100, y=mean_no2*100)) +
  geom_point() +
  ggtitle("All Calibrations vs No Notostraca Calibration") +
  labs(x = "Date estimates with all calibrations", y = "Date estimates without Notostraca calibration") +
  geom_abline(slope = 1, intercept = 0, lty=2, color = "#008080") +
  geom_errorbar(aes(xmin=all.tree$nodeAges[!(row.names(all.tree$nodeAges) %in% c("50")),2]*100, xmax=all.tree$nodeAges[!(row.names(all.tree$nodeAges) %in% c("50")),3]*100), width = 0.05, lty=2,col="salmon") +
  geom_errorbar(aes(ymin=no2.tree$nodeAges[!(row.names(no2.tree$nodeAges) %in% c("50")),2]*100, ymax=no2.tree$nodeAges[!(row.names(no2.tree$nodeAges) %in% c("50")),3]*100), width = 0.05, lty=2,col="salmon")

plot3 <- ggplot(dates,aes(x=mean_all*100, y=mean_no3*100)) +
  geom_point() +
  ggtitle("All Calibrations vs No Cladocera Calibration") +
  labs(x = "Date estimates with all calibrations", y = "Date estimates without Cladocera calibration") +
  geom_abline(slope = 1, intercept = 0, lty=2, color = "#008080") +
  geom_errorbar(aes(xmin=all.tree$nodeAges[!(row.names(all.tree$nodeAges) %in% c("50")),2]*100, xmax=all.tree$nodeAges[!(row.names(all.tree$nodeAges) %in% c("50")),3]*100), width = 0.05, lty=2,col="salmon") +
  geom_errorbar(aes(ymin=no3.tree$nodeAges[!(row.names(no3.tree$nodeAges) %in% c("50")),2]*100, ymax=no3.tree$nodeAges[!(row.names(no3.tree$nodeAges) %in% c("50")),3]*100), width = 0.05, lty=2,col="salmon")

plot4 <- ggplot(dates,aes(x=mean_all*100, y=mean_no4*100)) +
  geom_point() +
  ggtitle("All Calibrations vs No Branchiopoda Calibration") +
  labs(x = "Date estimates with all calibrations", y = "Date estimates without Branchiopoda calibration") +
  geom_abline(slope = 1, intercept = 0, lty=2, color = "#008080") +
  geom_errorbar(aes(xmin=all.tree$nodeAges[!(row.names(all.tree$nodeAges) %in% c("50")),2]*100, xmax=all.tree$nodeAges[!(row.names(all.tree$nodeAges) %in% c("50")),3]*100), width = 0.05, lty=2,col="salmon") +
  geom_errorbar(aes(ymin=no4.tree$nodeAges[!(row.names(no4.tree$nodeAges) %in% c("50")),2]*100, ymax=no4.tree$nodeAges[!(row.names(no4.tree$nodeAges) %in% c("50")),3]*100), width = 0.05, lty=2,col="salmon")

pdf("./Jackknife_scatterplot.pdf", width = 11.7, height = 8.3)
plot_grid(plot1, plot2, plot3, plot4, ncol = 2)
dev.off()

png("./Jackknife_scatterplot.png", width = 11.7 * 100, height = 8.3 * 100, units = "mm", res = 300)
plot_grid(plot1, plot2, plot3, plot4, ncol = 2)
dev.off()
